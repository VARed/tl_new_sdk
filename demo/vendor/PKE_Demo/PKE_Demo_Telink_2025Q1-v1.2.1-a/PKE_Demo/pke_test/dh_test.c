/********************************************************************************************************
 * @file    dh_test.c
 *
 * @brief   This is the source file for Telink RISC-V MCU
 *
 * @author  Driver Group
 * @date    2024
 *
 * @par     Copyright (c) 2024, Telink Semiconductor (Shanghai) Co., Ltd. ("TELINK")
 *
 *          Licensed under the Apache License, Version 2.0 (the "License");
 *          you may not use this file except in compliance with the License.
 *          You may obtain a copy of the License at
 *
 *              http://www.apache.org/licenses/LICENSE-2.0
 *
 *          Unless required by applicable law or agreed to in writing, software
 *          distributed under the License is distributed on an "AS IS" BASIS,
 *          WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *          See the License for the specific language governing permissions and
 *          limitations under the License.
 *
 *******************************************************************************************************/
#include <stdio.h>

#include "lib/include/pke/pke_config.h"

#ifdef SUPPORT_DH

#include "lib/include/pke/dh.h"
#include "lib/include/crypto_common/utility.h"

// #define DH_SPEED_TEST_BY_TIMER

#ifdef DH_SPEED_TEST_BY_TIMER
extern unsigned int startp(void);
extern unsigned int endp(unsigned char mode, unsigned int once_bytes, unsigned int round);
#endif

#define DH_ROUND1 (2)
#define DH_ROUND2 (20)

/**
 * @brief           Internal function to test DH key exchange.
 * @param[in]       dh_para              - Pointer to the DH parameters.
 * @param[in]       local_prikey         - Local private key.
 * @param[in]       local_pubkey         - Local public key.
 * @param[in]       peer_prikey          - Peer private key.
 * @param[in]       peer_pubkey          - Peer public key.
 * @param[in]       std_key              - Standard key for comparison.
 * @param[in]       info                 - Additional information for logging.
 * @return          0 if the test is successful, 1 otherwise.
 */
unsigned int dh_test_internal(const dh_para_t *dh_para, unsigned char *local_prikey, unsigned char *local_pubkey, unsigned char *peer_prikey, unsigned char *peer_pubkey,
                              unsigned char *std_key, char *info)
{
    unsigned char local_key[DH_MAX_BYTE_LEN];
    unsigned char peer_key[DH_MAX_BYTE_LEN];
    // unsigned char tmp[DH_MAX_BYTE_LEN];
    unsigned int p_len = get_byte_len(dh_para->p_bits);
    unsigned int ret;

// standard inputs
#ifdef DH_SEC_TEST
    ret = dh_compute_key_s(dh_para, local_prikey, peer_pubkey, local_key);
    if (DH_SUCCESS_S != ret ||
#else
    ret = dh_compute_key(dh_para, local_prikey, peer_pubkey, local_key);
    if (DH_SUCCESS != ret ||
#endif
        ((NULL != std_key) && memcmp_(local_key, std_key, p_len)))
    {
        printf("\r\n %s DH test error 1, ret = %02x", info, ret);
        if (std_key)
        {
            print_buf_u8(std_key, p_len, "std key");
        }
        print_buf_u8(local_key, p_len, "local key");
        return 1;
    }
#ifdef DH_SEC_TEST
    ret = dh_compute_key_s(dh_para, peer_prikey, local_pubkey, peer_key);
    if (DH_SUCCESS_S != ret ||
#else
    ret = dh_compute_key(dh_para, peer_prikey, local_pubkey, peer_key);
    if (DH_SUCCESS != ret ||
#endif
        memcmp_(local_key, peer_key, p_len) || ((NULL != std_key) && memcmp_(peer_key, std_key, p_len)))
    {
        printf("\r\n %s DH test error 2, ret = %02x", info, ret);
        if (std_key)
        {
            print_buf_u8(std_key, p_len, "std key");
        }
        print_buf_u8(local_key, p_len, "local key");
        print_buf_u8(peer_key, p_len, "peer key");
        return 1;
    }

    return 0;
}

#if (DH_MAX_BIT_LEN >= 1024)
// data ref : ANSI X9.42 2003 Annex D.3.1
// unsigned char big-endian
const unsigned char p_s_1[128] = {
    0xE0,
    0x01,
    0xE8,
    0x96,
    0x7D,
    0xB4,
    0x93,
    0x53,
    0xE1,
    0x6F,
    0x8E,
    0x89,
    0x22,
    0x0C,
    0xCE,
    0xFC,
    0x5C,
    0x5F,
    0x12,
    0xE3,
    0xDF,
    0xF8,
    0xF1,
    0xD1,
    0x49,
    0x90,
    0x12,
    0xE6,
    0xEF,
    0x53,
    0xE3,
    0x1F,
    0x02,
    0xEA,
    0xCC,
    0x5A,
    0xDD,
    0xF3,
    0x37,
    0x89,
    0x35,
    0xC9,
    0x5B,
    0x21,
    0xEA,
    0x3D,
    0x6F,
    0x1C,
    0xD7,
    0xCE,
    0x63,
    0x75,
    0x52,
    0xEC,
    0x38,
    0x6C,
    0x0E,
    0x34,
    0xF7,
    0x36,
    0xAD,
    0x95,
    0x17,
    0xEF,
    0xFE,
    0x5E,
    0x4D,
    0xA7,
    0xA8,
    0x6A,
    0xF9,
    0x0E,
    0x2C,
    0x22,
    0x8F,
    0xE4,
    0xB9,
    0xE6,
    0xD8,
    0xF8,
    0xF0,
    0x2D,
    0x20,
    0xAF,
    0x78,
    0xAB,
    0xB6,
    0x92,
    0xAC,
    0xBC,
    0x4B,
    0x23,
    0xFA,
    0xF2,
    0xC5,
    0xCC,
    0xD4,
    0x9A,
    0x0C,
    0x9A,
    0x8B,
    0xCD,
    0x91,
    0xAC,
    0x0C,
    0x55,
    0x92,
    0x01,
    0xE6,
    0xC2,
    0xFD,
    0x1F,
    0x47,
    0xC2,
    0xCB,
    0x2A,
    0x88,
    0xA8,
    0x3C,
    0x21,
    0x0F,
    0xC0,
    0x54,
    0xDB,
    0x29,
    0x2D,
    0xBC,
    0x45,
};
const unsigned char p_s_1_h[128] = {
    0x0F,
    0xE0,
    0xEF,
    0x1D,
    0x93,
    0xFE,
    0xF1,
    0x06,
    0xEA,
    0x49,
    0x16,
    0xD0,
    0x83,
    0xEC,
    0xD2,
    0x7E,
    0xAF,
    0x2A,
    0xC8,
    0x86,
    0x19,
    0x40,
    0xCD,
    0xE1,
    0xC4,
    0xA4,
    0xF9,
    0x52,
    0x41,
    0xE6,
    0xDF,
    0x31,
    0x15,
    0xBF,
    0x8C,
    0xB1,
    0xD2,
    0x59,
    0xC8,
    0x43,
    0x0C,
    0xD0,
    0xCC,
    0x01,
    0x6F,
    0x4C,
    0xF0,
    0x61,
    0x0E,
    0xDA,
    0xB8,
    0xE6,
    0x84,
    0x72,
    0x90,
    0x7C,
    0x20,
    0x9F,
    0x25,
    0xCA,
    0x5A,
    0xF7,
    0x27,
    0x8C,
    0x48,
    0xAE,
    0xB5,
    0x30,
    0xCA,
    0x83,
    0xDB,
    0x40,
    0x6A,
    0x1D,
    0xA7,
    0xB5,
    0xFD,
    0x21,
    0x46,
    0x17,
    0x7D,
    0x00,
    0x51,
    0x96,
    0xEB,
    0xAE,
    0xE6,
    0x56,
    0xC3,
    0x4B,
    0x25,
    0xEA,
    0xD7,
    0x42,
    0x32,
    0x75,
    0xD3,
    0x17,
    0x5F,
    0xCE,
    0x3F,
    0xD5,
    0xCF,
    0xE5,
    0x25,
    0xFD,
    0xA9,
    0xF7,
    0x0A,
    0x7E,
    0xA3,
    0xA8,
    0x35,
    0x76,
    0xD5,
    0xE4,
    0x10,
    0xDD,
    0xCF,
    0xD3,
    0x2B,
    0x17,
    0x5F,
    0xB8,
    0x94,
    0x55,
    0xDA,
    0xDF,
};
const unsigned char p_s_1_n0[4] = {0xAD, 0xDE, 0x09, 0x73};
const unsigned char q_s_1[20] = {
    0x86,
    0x47,
    0x17,
    0xA3,
    0x9E,
    0x6A,
    0xEA,
    0x7E,
    0x87,
    0xC4,
    0x32,
    0xEE,
    0x77,
    0x43,
    0x15,
    0x16,
    0x96,
    0x70,
    0xC4,
    0x99,
};
const unsigned char g_s_1[128] = {
    0x1C,
    0xE0,
    0xF6,
    0x69,
    0x26,
    0x46,
    0x11,
    0x97,
    0xEF,
    0x45,
    0xC4,
    0x65,
    0x8B,
    0x83,
    0xB8,
    0xAB,
    0x04,
    0xA9,
    0x22,
    0x42,
    0x68,
    0x50,
    0x4D,
    0x05,
    0xB8,
    0x19,
    0x83,
    0x99,
    0xDD,
    0x71,
    0x37,
    0x18,
    0xCC,
    0x1F,
    0x24,
    0x5D,
    0x47,
    0x6C,
    0xCF,
    0x61,
    0xA2,
    0xF9,
    0x34,
    0x93,
    0xF4,
    0x1F,
    0x55,
    0x52,
    0x48,
    0x65,
    0x57,
    0xE6,
    0xD4,
    0xCA,
    0xA8,
    0x00,
    0xD6,
    0xD0,
    0xDB,
    0x3C,
    0xBF,
    0x5A,
    0x95,
    0x4B,
    0x20,
    0x8A,
    0x4E,
    0xBA,
    0xF7,
    0xE6,
    0x49,
    0xFB,
    0x61,
    0x24,
    0xD8,
    0xA2,
    0x1E,
    0xF2,
    0xF2,
    0x2B,
    0xAA,
    0xAE,
    0x29,
    0x21,
    0x10,
    0x19,
    0x10,
    0x51,
    0x46,
    0x47,
    0x31,
    0xB6,
    0xCC,
    0x3C,
    0x93,
    0xDC,
    0x6E,
    0x80,
    0xBA,
    0x16,
    0x0B,
    0x66,
    0x64,
    0xA5,
    0x6C,
    0xFA,
    0x96,
    0xEA,
    0xF1,
    0xB2,
    0x83,
    0x39,
    0x8E,
    0xB4,
    0x61,
    0x64,
    0xE5,
    0xE9,
    0x43,
    0x84,
    0xEE,
    0x02,
    0x24,
    0xE7,
    0x1F,
    0x03,
    0x7C,
    0x23,
};

// unsigned int little-endian
unsigned int p_s_1_u32[32] = {
    0x292DBC45,
    0x0FC054DB,
    0x88A83C21,
    0x47C2CB2A,
    0xE6C2FD1F,
    0x0C559201,
    0x8BCD91AC,
    0xD49A0C9A,
    0xFAF2C5CC,
    0xACBC4B23,
    0x78ABB692,
    0xF02D20AF,
    0xB9E6D8F8,
    0x2C228FE4,
    0xA86AF90E,
    0xFE5E4DA7,
    0xAD9517EF,
    0x0E34F736,
    0x52EC386C,
    0xD7CE6375,
    0xEA3D6F1C,
    0x35C95B21,
    0xDDF33789,
    0x02EACC5A,
    0xEF53E31F,
    0x499012E6,
    0xDFF8F1D1,
    0x5C5F12E3,
    0x220CCEFC,
    0xE16F8E89,
    0x7DB49353,
    0xE001E896,
};
unsigned int p_s_1_h_u32[32] = {
    0x9455DADF,
    0x2B175FB8,
    0x10DDCFD3,
    0x3576D5E4,
    0x0A7EA3A8,
    0x25FDA9F7,
    0x3FD5CFE5,
    0xD3175FCE,
    0xD7423275,
    0xC34B25EA,
    0xEBAEE656,
    0x7D005196,
    0xFD214617,
    0x6A1DA7B5,
    0xCA83DB40,
    0x48AEB530,
    0x5AF7278C,
    0x209F25CA,
    0x8472907C,
    0x0EDAB8E6,
    0x6F4CF061,
    0x0CD0CC01,
    0xD259C843,
    0x15BF8CB1,
    0x41E6DF31,
    0xC4A4F952,
    0x1940CDE1,
    0xAF2AC886,
    0x83ECD27E,
    0xEA4916D0,
    0x93FEF106,
    0x0FE0EF1D,
};
unsigned int p_s_1_n0_u32[1] = {0xADDE0973};
unsigned int q_s_1_u32[5] = {0x9670C499, 0x77431516, 0x87C432EE, 0x9E6AEA7E, 0x864717A3};
unsigned int g_s_1_u32[32] = {
    0x1F037C23,
    0xEE0224E7,
    0xE5E94384,
    0x8EB46164,
    0xF1B28339,
    0x6CFA96EA,
    0x0B6664A5,
    0x6E80BA16,
    0xCC3C93DC,
    0x464731B6,
    0x10191051,
    0xAAAE2921,
    0x1EF2F22B,
    0x6124D8A2,
    0xF7E649FB,
    0x208A4EBA,
    0xBF5A954B,
    0xD6D0DB3C,
    0xD4CAA800,
    0x486557E6,
    0xF41F5552,
    0xA2F93493,
    0x476CCF61,
    0xCC1F245D,
    0xDD713718,
    0xB8198399,
    0x68504D05,
    0x04A92242,
    0x8B83B8AB,
    0xEF45C465,
    0x26461197,
    0x1CE0F669,
};

dh_para_t dh_para_dh_static_1024_160[1] = {{
    1024,
    160,
    1024,
    (unsigned int *)p_s_1_u32,
    (unsigned int *)p_s_1_h_u32,
    (unsigned int *)p_s_1_n0_u32,
    (unsigned int *)q_s_1_u32,
    (unsigned int *)g_s_1_u32,
}};

/**
 * @brief           Test DH key exchange with standard 1024-bit static parameters.
 * @return          0 if the test is successful, 1 otherwise.
 */
unsigned int dh_static_1024_160_std_test(void)
{
    // data ref : ANSI X9.42 2003 Annex D.3.1
    unsigned char a_pri_key[] = {0x53, 0x8D, 0x3D, 0x64, 0x27, 0x4A, 0x40, 0x05, 0x9B, 0x9C, 0x26, 0xE9, 0x13, 0xE6, 0x91, 0x53, 0x23, 0x7B, 0x55, 0x83};
    unsigned char a_pub_key[] = {0xBB, 0xE9, 0x18, 0xDD, 0x4B, 0x2B, 0x94, 0x1B, 0x10, 0x0E, 0x88, 0x35, 0x28, 0x68, 0xFC, 0x62, 0x04, 0x38, 0xA6, 0xDB, 0x32, 0xA6,
                                 0x9E, 0xEE, 0x6C, 0x6F, 0x45, 0x1C, 0xA3, 0xA6, 0xD5, 0x37, 0x77, 0x75, 0x5B, 0xC1, 0x37, 0x0A, 0xCE, 0xFE, 0x2B, 0x8F, 0x13, 0xA9,
                                 0x14, 0x2C, 0x5B, 0x44, 0x15, 0x78, 0x86, 0x30, 0xD6, 0x95, 0xB1, 0x92, 0x20, 0x63, 0xA3, 0xCF, 0x9D, 0xEF, 0x65, 0x61, 0x27, 0x4D,
                                 0x24, 0x01, 0xE7, 0xA1, 0x45, 0xF2, 0xD8, 0xB9, 0x3A, 0x45, 0x17, 0xF4, 0x19, 0xD0, 0x5E, 0xF8, 0xCB, 0x35, 0x59, 0x37, 0x9D, 0x04,
                                 0x20, 0xA3, 0xBF, 0x02, 0xAD, 0xFE, 0xA8, 0x60, 0xB2, 0xC3, 0xEE, 0x85, 0x58, 0x90, 0xF3, 0xB5, 0x57, 0x2B, 0xB4, 0xEF, 0xD7, 0x8F,
                                 0x37, 0x68, 0x78, 0x7C, 0x71, 0x52, 0x9D, 0x5E, 0x0A, 0x61, 0x4F, 0x09, 0x89, 0x92, 0x39, 0xF7, 0x4B, 0x01};
    unsigned char b_pri_key[] = {0x70, 0x57, 0xC2, 0xA0, 0x9F, 0xCB, 0x97, 0x16, 0xAD, 0x48, 0x88, 0xDE, 0xC2, 0x94, 0x96, 0x77, 0xA1, 0x50, 0x52, 0x2F};
    unsigned char b_pub_key[] = {0xA3, 0xF5, 0x7D, 0xBE, 0x9E, 0x2F, 0x0A, 0xDA, 0xA9, 0x4E, 0x4E, 0x6A, 0xF0, 0xE0, 0x71, 0x47, 0x0E, 0x2E, 0x41, 0x2E, 0xDE, 0x73,
                                 0x2A, 0x62, 0x14, 0xC3, 0x7C, 0x26, 0xD4, 0xE9, 0x9A, 0x54, 0xBA, 0x3D, 0xE7, 0x49, 0x85, 0x95, 0x0E, 0xE9, 0x14, 0xB2, 0x90, 0x22,
                                 0x91, 0xDC, 0xFF, 0x61, 0xB2, 0xFC, 0xD1, 0xD0, 0x1B, 0x11, 0x14, 0xB6, 0x02, 0x64, 0x2B, 0x26, 0x5D, 0x88, 0xEA, 0x8D, 0xBB, 0xE2,
                                 0x07, 0x0B, 0x48, 0xFB, 0x01, 0x53, 0x55, 0x1E, 0x59, 0x51, 0x36, 0xF2, 0xF9, 0xD1, 0x97, 0xFB, 0x66, 0x12, 0x84, 0x5D, 0xED, 0xB8,
                                 0x9B, 0x2D, 0x3E, 0x2B, 0x8C, 0xEB, 0x2A, 0x72, 0x40, 0x9D, 0x55, 0x4C, 0xED, 0xEB, 0x55, 0x02, 0xFF, 0x8C, 0xB0, 0x2E, 0x03, 0x65,
                                 0x3F, 0x41, 0xB1, 0xAC, 0xA3, 0x30, 0x6B, 0xFF, 0x6D, 0xF4, 0x6D, 0xE6, 0xE1, 0x0F, 0x86, 0x7C, 0x43, 0x64};
    unsigned char std_key[] = {0x4E, 0x6A, 0xCF, 0xFD, 0x7D, 0x14, 0x27, 0x65, 0xEB, 0xF4, 0xC7, 0x12, 0x41, 0x4F, 0xE4, 0xB6, 0xAB, 0x95, 0x7F, 0x4C, 0xB4, 0x66,
                               0xB4, 0x66, 0x01, 0x28, 0x9B, 0xB8, 0x20, 0x60, 0x42, 0x82, 0x72, 0x84, 0x2E, 0xE2, 0x8F, 0x11, 0x3C, 0xD1, 0x1F, 0x39, 0x43, 0x1C,
                               0xBF, 0xFD, 0x82, 0x32, 0x54, 0xCE, 0x47, 0x2E, 0x21, 0x05, 0xE4, 0x9B, 0x3D, 0x7F, 0x11, 0x3B, 0x82, 0x50, 0x76, 0xE6, 0x26, 0x45,
                               0x85, 0x80, 0x7B, 0xC4, 0x64, 0x54, 0x66, 0x5F, 0x27, 0xC5, 0xE4, 0xE1, 0xA4, 0xBD, 0x03, 0x47, 0x04, 0x86, 0x32, 0x29, 0x81, 0xFD,
                               0xC8, 0x94, 0xCC, 0xA1, 0xE2, 0x93, 0x09, 0x87, 0xC9, 0x2C, 0x15, 0xA3, 0x8B, 0xC4, 0x2E, 0xB3, 0x88, 0x10, 0xE8, 0x67, 0xC4, 0x43,
                               0x2F, 0x07, 0x25, 0x9E, 0xC0, 0x0C, 0xDB, 0xBB, 0x0F, 0xB9, 0x9E, 0x17, 0x27, 0xC7, 0x06, 0xDA, 0x58, 0xDD};
    unsigned char pubkey[(1024 + 7) / 8];
    unsigned int p_buf[(1024 + 31) / 32];
    unsigned int p_h_buf[(1024 + 31) / 32];
    unsigned int p_n0_buf[(32 + 31) / 32];
    unsigned int q_buf[(160 + 31) / 32];
    unsigned int g_buf[(1024 + 31) / 32];
    unsigned int i, ret;
    dh_para_t dh_para_array[1];
    dh_para_t *dh_para = dh_para_array;

    // 6 sample to get dh_para ready.
    for (i = 0; i < 6; i++)
    {
        printf("\r\n init %u", i + 1);
        fflush(stdout);
        memset_((unsigned char *)dh_para, 0, sizeof(dh_para_t));
        if (0 == i) // init without p_h, p_n0
        {
            ret = dh_param_pointer_init(dh_para, p_buf, 1024, NULL, NULL, q_buf, 160, g_buf, 1024);
            if (DH_SUCCESS != ret)
            {
                printf("\r\n dh_param_pointer_init error %u, ret = %x", i, ret);
                fflush(stdout);
                return 1;
            }

            ret = dh_param_value_init(dh_para, p_s_1, NULL, NULL, q_s_1, g_s_1);
            if (DH_SUCCESS != ret)
            {
                printf("\r\n dh_param_value_init error %u, ret = %x", i, ret);
                fflush(stdout);
                return 1;
            }
        }
        else if (1 == i) // init with p_h, p_n0(unsigned char big-endian)
        {
            ret = dh_param_pointer_init(dh_para, p_buf, 1024, p_h_buf, p_n0_buf, q_buf, 160, g_buf, 1024);
            if (DH_SUCCESS != ret)
            {
                printf("\r\n dh_param_pointer_init error %u, ret = %x", i, ret);
                fflush(stdout);
                return 1;
            }

            ret = dh_param_value_init(dh_para, p_s_1, p_s_1_h, p_s_1_n0, q_s_1, g_s_1);
            if (DH_SUCCESS != ret)
            {
                printf("\r\n dh_param_value_init error %u, ret = %x", i, ret);
                fflush(stdout);
                return 1;
            }
        }
        else if ((2 == i) || (3 == i)) // init with p_h, p_n0(unsigned int little-endian)
        {
            ret = dh_param_pointer_init(dh_para, p_buf, 1024, p_h_buf, p_n0_buf, q_buf, 160, g_buf, 1024);
            if (DH_SUCCESS != ret)
            {
                printf("\r\n dh_param_pointer_init error %u, ret = %x", i, ret);
                fflush(stdout);
                return 1;
            }

            ret = dh_param_value_init(dh_para, p_s_1, NULL, NULL, q_s_1, g_s_1);
            if (DH_SUCCESS != ret)
            {
                printf("\r\n dh_param_value_init error %u, ret = %x", i, ret);
                fflush(stdout);
                return 1;
            }

            if (2 == i) // copy p_h, p_n0 value if provided
            {
                uint32_copy(dh_para->p_h, (unsigned int *)p_s_1_h_u32, (dh_para->p_bits + 31) / 32);
                uint32_copy(dh_para->p_n0, (unsigned int *)p_s_1_n0_u32, (32 + 31) / 32);
            }
            else // calculate p_h, p_n0 value
            {
                ret = pke_pre_calc_mont(dh_para->p, dh_para->p_bits, dh_para->p_h, dh_para->p_n0);
                if (DH_SUCCESS != ret)
                {
                    printf("\r\n pke_pre_calc_mont error %u, ret = %x", i, ret);
                    fflush(stdout);
                    return 1;
                }
            }
        }
        else if (4 == i) // dh_para ready without p_h, p_n0
        {
            memcpy_((unsigned char *)dh_para, (const unsigned char *)dh_para_dh_static_1024_160, sizeof(dh_para_t));
            dh_para->p_h = NULL;
            dh_para->p_n0 = NULL;
        }
        else if (5 == i) // dh_para ready with p_h, p_n0
        {
            dh_para = dh_para_dh_static_1024_160;
        }

        memset_((unsigned char *)pubkey, 0, sizeof(pubkey));
        ret = dh_generate_pubkey_from_prikey(dh_para, a_pri_key, pubkey);
        if ((DH_SUCCESS != ret) || memcmp_(pubkey, a_pub_key, (1024 + 7) / 8))
        {
            printf("\r\n generate A public key error %u, ret = %x", i, ret);
            fflush(stdout);
            print_buf_u8(pubkey, (1024 + 7) / 8, "A public key");
            return 1;
        }

        memset_((unsigned char *)pubkey, 0, sizeof(pubkey));
        ret = dh_generate_pubkey_from_prikey(dh_para, b_pri_key, pubkey);
        if ((DH_SUCCESS != ret) || memcmp_(pubkey, b_pub_key, (1024 + 7) / 8))
        {
            printf("\r\n generate B public key error %u, ret = %x", i, ret);
            fflush(stdout);
            print_buf_u8(pubkey, (1024 + 7) / 8, "A public key");
            return 1;
        }

        ret = dh_test_internal(dh_para, a_pri_key, a_pub_key, b_pri_key, b_pub_key, std_key, "dhStatic(1024-160)");
        if (DH_SUCCESS != ret)
        {
            printf("\r\n dh_test_internal error %u, ret = %x", i, ret);
            fflush(stdout);
            return 1;
        }
    }

    printf("\r\n dhStatic(1024-160) standard data test success");
    fflush(stdout);

    return 0;
}
#endif

#if (DH_MAX_BIT_LEN >= 1024)
// data ref : ANSI X9.42 2003 Annex D.3.2
const unsigned char p_e_1[128] = {
    0xD7,
    0x57,
    0x26,
    0x2C,
    0x45,
    0x84,
    0xC4,
    0x4C,
    0x21,
    0x1F,
    0x18,
    0xBD,
    0x96,
    0xE5,
    0xF0,
    0x61,
    0xC4,
    0xF0,
    0xA4,
    0x23,
    0xF7,
    0xFE,
    0x6B,
    0x6B,
    0x85,
    0xB3,
    0x4C,
    0xEF,
    0x72,
    0xCE,
    0x14,
    0xA0,
    0xD3,
    0xA5,
    0x22,
    0x2F,
    0xE0,
    0x8C,
    0xEC,
    0xE6,
    0x5B,
    0xE6,
    0xC2,
    0x65,
    0x85,
    0x48,
    0x89,
    0xDC,
    0x1E,
    0xDB,
    0xD1,
    0x3E,
    0xC8,
    0xB2,
    0x74,
    0xDA,
    0x9F,
    0x75,
    0xBA,
    0x26,
    0xCC,
    0xB9,
    0x87,
    0x72,
    0x36,
    0x02,
    0x78,
    0x7E,
    0x92,
    0x2B,
    0xA8,
    0x44,
    0x21,
    0xF2,
    0x2C,
    0x3C,
    0x89,
    0xCB,
    0x9B,
    0x06,
    0xFD,
    0x60,
    0xFE,
    0x01,
    0x94,
    0x1D,
    0xDD,
    0x77,
    0xFE,
    0x6B,
    0x12,
    0x89,
    0x3D,
    0xA7,
    0x6E,
    0xEB,
    0xC1,
    0xD1,
    0x28,
    0xD9,
    0x7F,
    0x06,
    0x78,
    0xD7,
    0x72,
    0x2B,
    0x53,
    0x41,
    0xC8,
    0x50,
    0x6F,
    0x35,
    0x82,
    0x14,
    0xB1,
    0x6A,
    0x2F,
    0xAC,
    0x4B,
    0x36,
    0x89,
    0x50,
    0x38,
    0x78,
    0x11,
    0xC7,
    0xDA,
    0x33,
};
const unsigned char q_e_1[20] = {
    0xC7,
    0x73,
    0x21,
    0x8C,
    0x73,
    0x7E,
    0xC8,
    0xEE,
    0x99,
    0x3B,
    0x4F,
    0x2D,
    0xED,
    0x30,
    0xF4,
    0x8E,
    0xDA,
    0xCE,
    0x91,
    0x5F,
};
const unsigned char g_e_1[128] = {
    0x82,
    0x26,
    0x90,
    0x09,
    0xE1,
    0x4E,
    0xC4,
    0x74,
    0xBA,
    0xF2,
    0x93,
    0x2E,
    0x69,
    0xD3,
    0xB1,
    0xF1,
    0x85,
    0x17,
    0xAD,
    0x95,
    0x94,
    0x18,
    0x4C,
    0xCD,
    0xFC,
    0xEA,
    0xE9,
    0x6E,
    0xC4,
    0xD5,
    0xEF,
    0x93,
    0x13,
    0x3E,
    0x84,
    0xB4,
    0x70,
    0x93,
    0xC5,
    0x2B,
    0x20,
    0xCD,
    0x35,
    0xD0,
    0x24,
    0x92,
    0xB3,
    0x95,
    0x9E,
    0xC6,
    0x49,
    0x96,
    0x25,
    0xBC,
    0x4F,
    0xA5,
    0x08,
    0x2E,
    0x22,
    0xC5,
    0xB3,
    0x74,
    0xE1,
    0x6D,
    0xD0,
    0x01,
    0x32,
    0xCE,
    0x71,
    0xB0,
    0x20,
    0x21,
    0x70,
    0x91,
    0xAC,
    0x71,
    0x7B,
    0x61,
    0x23,
    0x91,
    0xC7,
    0x6C,
    0x1F,
    0xB2,
    0xE8,
    0x83,
    0x17,
    0xC1,
    0xBD,
    0x81,
    0x71,
    0xD4,
    0x1E,
    0xCB,
    0x83,
    0xE2,
    0x10,
    0xC0,
    0x3C,
    0xC9,
    0xB3,
    0x2E,
    0x81,
    0x05,
    0x61,
    0xC2,
    0x16,
    0x21,
    0xC7,
    0x3D,
    0x6D,
    0xAA,
    0xC0,
    0x28,
    0xF4,
    0xB1,
    0x58,
    0x5D,
    0xA7,
    0xF4,
    0x25,
    0x19,
    0x71,
    0x8C,
    0xC9,
    0xB0,
    0x9E,
    0xEF,
};

/**
 * @brief           Test DH key exchange with standard 1024-bit ephemeral parameters.
 * @return          0 if the test is successful, 1 otherwise.
 */
unsigned int dh_ephemeral_1024_160_std_test(void)
{
    // data ref : ANSI X9.42 2003 Annex D.3.2
    unsigned char a_pri_key[] = {0x50, 0x54, 0x02, 0x9C, 0x71, 0x03, 0x4F, 0xF1, 0x3E, 0x3F, 0x19, 0x60, 0x6A, 0xC1, 0x83, 0x59, 0xDA, 0xFC, 0xB5, 0xE1};
    unsigned char a_pub_key[] = {0x29, 0xFA, 0xEB, 0xDE, 0x6D, 0x75, 0x21, 0x6C, 0xC5, 0x35, 0x42, 0xB7, 0x01, 0xFD, 0x23, 0x19, 0xE3, 0xC2, 0x02, 0x9C, 0x70, 0x5F,
                                 0x32, 0xD7, 0x5D, 0xFF, 0x51, 0xFD, 0xFA, 0xA5, 0xBB, 0x46, 0x2C, 0x19, 0x9C, 0x92, 0xF2, 0xFD, 0x53, 0x43, 0x1D, 0x57, 0x5F, 0x39,
                                 0x8E, 0xAB, 0x1D, 0xDD, 0xEB, 0x37, 0x53, 0xBA, 0xF2, 0x1B, 0x37, 0x61, 0x7D, 0xF8, 0xC3, 0x0D, 0x9A, 0xC5, 0x66, 0xD6, 0xB2, 0xD5,
                                 0xE6, 0x93, 0x18, 0xC6, 0xF8, 0xCB, 0x5F, 0x4D, 0x39, 0x40, 0xBE, 0xA1, 0x4B, 0x1E, 0xF5, 0x0D, 0xBD, 0x17, 0xA5, 0x8F, 0x6C, 0xA3,
                                 0x7F, 0x35, 0x0F, 0x68, 0xDA, 0xC0, 0xDF, 0x1B, 0xE6, 0x89, 0x13, 0x7D, 0x19, 0xED, 0x33, 0xB5, 0xA5, 0xE6, 0xCC, 0x54, 0x54, 0xE2,
                                 0xDB, 0xA5, 0x6E, 0x8F, 0x86, 0x44, 0x3F, 0x63, 0x13, 0x6C, 0x44, 0xC2, 0x0F, 0x5F, 0x10, 0xA4, 0xAB, 0xB4};
    unsigned char b_pri_key[] = {0x6A, 0x4F, 0x4E, 0x4B, 0x75, 0x00, 0x52, 0xA7, 0xE9, 0xBC, 0x14, 0xE1, 0xA9, 0x0A, 0xFF, 0xC0, 0xC8, 0xA6, 0x73, 0x2E};
    unsigned char b_pub_key[] = {0x41, 0xBF, 0xC7, 0x4E, 0xB8, 0x58, 0xB8, 0x50, 0x88, 0xD8, 0x54, 0x04, 0x28, 0xA3, 0x9A, 0x54, 0xA1, 0x19, 0xA7, 0x25, 0xFF, 0x8F,
                                 0xF5, 0x7C, 0x30, 0x23, 0x26, 0x97, 0x85, 0xAA, 0x93, 0xDE, 0xA4, 0x50, 0x69, 0xEF, 0x12, 0x42, 0xBA, 0xDD, 0x88, 0xBB, 0x46, 0x3E,
                                 0x13, 0xA2, 0x53, 0x5C, 0xCA, 0xAE, 0x6C, 0xB1, 0xC3, 0x27, 0x68, 0xCE, 0x85, 0x0F, 0x1B, 0x24, 0x60, 0x86, 0x88, 0x10, 0x2B, 0xAC,
                                 0x1B, 0x10, 0x7A, 0xBB, 0xD4, 0xE8, 0x17, 0xA8, 0x7D, 0x1F, 0xC9, 0xDE, 0x68, 0x62, 0x9C, 0xB2, 0x73, 0xD8, 0xC8, 0xC1, 0x55, 0xBA,
                                 0x7E, 0xDF, 0xA9, 0x44, 0x84, 0x58, 0x52, 0x0C, 0x0D, 0x90, 0x65, 0xE3, 0xF3, 0x15, 0x9F, 0xF4, 0xC0, 0xFF, 0x1E, 0x71, 0xFB, 0xCC,
                                 0xC1, 0xEC, 0x4D, 0x5E, 0x0F, 0x04, 0x74, 0xB3, 0xDF, 0xFA, 0x72, 0xD1, 0x45, 0x0F, 0x1D, 0x99, 0xF2, 0x7C};
    unsigned char std_key[] = {0x5E, 0x10, 0xB9, 0x67, 0xA9, 0x56, 0x06, 0x85, 0x3E, 0x52, 0x8F, 0x04, 0x26, 0x2A, 0xD1, 0x8A, 0x47, 0x67, 0xC7, 0x61, 0x16, 0x39,
                               0x71, 0x39, 0x1E, 0x17, 0xCB, 0x05, 0xA2, 0x16, 0x68, 0xD4, 0xCE, 0x2B, 0x9F, 0x15, 0x16, 0x17, 0x40, 0x80, 0x42, 0xCE, 0x09, 0x19,
                               0x58, 0x38, 0x23, 0xFD, 0x34, 0x6D, 0x17, 0x51, 0xFB, 0xE2, 0x34, 0x1A, 0xF2, 0xEE, 0x04, 0x61, 0xB6, 0x2F, 0x10, 0x0F, 0xFA, 0xD4,
                               0xF7, 0x23, 0xF7, 0x0C, 0x18, 0xB3, 0x82, 0x38, 0xED, 0x18, 0x3E, 0X93, 0x98, 0xC8, 0xCA, 0x51, 0x7E, 0xE0, 0xCB, 0xBE, 0xFF, 0xF9,
                               0xC5, 0x94, 0x71, 0xFE, 0x27, 0x80, 0x93, 0x92, 0x40, 0x89, 0x48, 0x0D, 0xBC, 0x5A, 0x38, 0xE9, 0xA1, 0xA9, 0x7D, 0x23, 0x03, 0x81,
                               0x06, 0x84, 0x7D, 0x0D, 0x22, 0xEC, 0xF8, 0x5F, 0x49, 0xA8, 0x61, 0x82, 0x11, 0x99, 0xBA, 0xFC, 0xB0, 0xD7};
    unsigned char pubkey[(1024 + 7) / 8];
    unsigned int p_buf[(1024 + 31) / 32];
    unsigned int q_buf[(160 + 31) / 32];
    unsigned int g_buf[(1024 + 31) / 32];
    unsigned int ret;
    dh_para_t dh_para[1];

    ret = dh_param_pointer_init(dh_para, p_buf, 1024, NULL, NULL, q_buf, 160, g_buf, 1024);
    if (DH_SUCCESS != ret)
    {
        printf("\r\n dh_param_pointer_init error, ret = %x", ret);
        fflush(stdout);
        return 1;
    }

    ret = dh_param_value_init(dh_para, p_e_1, NULL, NULL, q_e_1, g_e_1);
    if (DH_SUCCESS != ret)
    {
        printf("\r\n dh_param_value_init error, ret = %x", ret);
        fflush(stdout);
        return 1;
    }

    ret = dh_generate_pubkey_from_prikey(dh_para, a_pri_key, pubkey);
    if ((DH_SUCCESS != ret) || memcmp_(pubkey, a_pub_key, (1024 + 7) / 8))
    {
        printf("\r\n generate A public key error, ret = %x", ret);
        fflush(stdout);
        print_buf_u8(pubkey, (1024 + 7) / 8, "A public key");
        return 1;
    }

    ret = dh_generate_pubkey_from_prikey(dh_para, b_pri_key, pubkey);
    if ((DH_SUCCESS != ret) || memcmp_(pubkey, b_pub_key, (1024 + 7) / 8))
    {
        printf("\r\n generate B public key error, ret = %x", ret);
        fflush(stdout);
        print_buf_u8(pubkey, (1024 + 7) / 8, "A public key");
        return 1;
    }

    ret = dh_test_internal(dh_para, a_pri_key, a_pub_key, b_pri_key, b_pub_key, std_key, "dhEpheme(1024-160)");
    if (DH_SUCCESS != ret)
    {
        // printf("\r\n dh_test_internal error, ret = %x", ret);fflush(stdout);
        return 1;
    }

    printf("\r\n dhEpheme(1024-160) standard data test success");
    fflush(stdout);

    return 0;
}
#endif

#if (DH_MAX_BIT_LEN >= 2048)
// data ref : RFC5114
// unsigned int little-endian
unsigned int p_rfc5114_2048_224_u32[64] = {
    0x0C10E64F,
    0x0AC4DFFE,
    0x4E71B81C,
    0xCF9DE538,
    0xFFA31F71,
    0x7EF363E2,
    0x6B8E75B9,
    0xE3FB73C1,
    0x4BA80A29,
    0xC9B53DCF,
    0x16E79763,
    0x23F10B0E,
    0x13042E9B,
    0xC52172E4,
    0xC928B2B9,
    0xBE60E69C,
    0xB9E587E8,
    0x80CD86A1,
    0x98C641A4,
    0x315D75E1,
    0x44328387,
    0xCDF93ACC,
    0xDC0A486D,
    0x15987D9A,
    0x1FD5A074,
    0x7310F712,
    0xDE31EFDC,
    0x278273C7,
    0x415D9330,
    0x1602E714,
    0xBC8985DB,
    0x81286130,
    0x70918836,
    0xB3BF8A31,
    0xB9C49708,
    0x6A00E0A0,
    0x8BBC27BE,
    0xC6BA0B2C,
    0xED34DBF6,
    0xC9F98D11,
    0xB6C12207,
    0x7AD5B7D0,
    0x55B7394B,
    0xD91E8FEF,
    0xEFDA4DF8,
    0x9037C9ED,
    0xAD6AC212,
    0x6D3F8152,
    0x1274A0A6,
    0x1DE6B85A,
    0x309C180E,
    0xEB3D688A,
    0x7BA1DF15,
    0xAF9A3C40,
    0xF95A56DB,
    0xE6FA141D,
    0xB61D0A75,
    0xB54B1597,
    0x683B9FD1,
    0xA20D64E5,
    0x9559C51F,
    0xD660FAA7,
    0x9123A9D0,
    0xAD107E1E,
};
unsigned int p_h_rfc5114_2048_224_u32[64] = {
    0x2EC2BD6B,
    0x3BB48B69,
    0x43836529,
    0x44C734B8,
    0xD8C671AA,
    0x2B522529,
    0xFE7D0A78,
    0x1B1C6BBC,
    0xCF4CE640,
    0xF35542D9,
    0x7F8C859C,
    0x3ADB125B,
    0xE76DCC8F,
    0x2FE74EBD,
    0xF00EDC9A,
    0x782B7D91,
    0xBF746299,
    0x983D71A4,
    0xE0B8F780,
    0xFCD65F0E,
    0xA986611D,
    0x0E59DF3E,
    0x36BB3CFA,
    0xEDA913B2,
    0x25AFAE57,
    0x096F6367,
    0x4F1F69D4,
    0x1F0DD87C,
    0xF6C223C3,
    0xF326176D,
    0x60C9E8A5,
    0x342EA7D4,
    0x703F2F11,
    0x613C1887,
    0x6054024F,
    0x4D0B5EBC,
    0xD3B6694A,
    0x4329764C,
    0xD84E86C1,
    0x8A9B8C76,
    0xEDC76B42,
    0x36858FC9,
    0x647C0452,
    0x3F462AF2,
    0x58ECB8D4,
    0x35E47D0C,
    0xEB59E616,
    0x8C873D52,
    0x03AEAB8D,
    0x66B25557,
    0xCD278A9D,
    0x3BF43296,
    0x6D86B7A2,
    0x7D04E4C9,
    0x927BA630,
    0x32A3D5F2,
    0x16008064,
    0xD552F36A,
    0x59E84817,
    0xF94DCF8D,
    0xC149DEAD,
    0x0CBAF2CD,
    0xDE5C8027,
    0x9CD7F320,
};
unsigned int p_n0_rfc5114_2048_224_u32[1] = {
    0x52AF8F51,
};
unsigned int q_rfc5114_2048_224_u32[7] = {0xB36371EB, 0xBF389A99, 0x4738CEBC, 0x1F80535A, 0x99717710, 0xC58D93FE, 0x801C0D34};
unsigned int g_rfc5114_2048_224_u32[64] = {
    0x191F2BFA,
    0x84B890D3,
    0x2A7065B3,
    0x81BC087F,
    0xF6EC0179,
    0x19C418E1,
    0x71CFFF4C,
    0x7B5A0F1C,
    0x9B6AA4BD,
    0xEDFE72FE,
    0x94B30269,
    0x81E1BCFE,
    0x8D6C0191,
    0x566AFBB4,
    0x409D13CD,
    0xB539CCE3,
    0x5F2FF381,
    0x6AA21E7F,
    0x770589EF,
    0xD9E263E4,
    0xD19963DD,
    0x10E183ED,
    0x150B8EEB,
    0xB70A8137,
    0x28C8F8AC,
    0x051AE3D4,
    0x0C1AB15B,
    0xBB77A86F,
    0x16A330EF,
    0x6E3025E3,
    0xD6F83456,
    0x19529A45,
    0x118E98D1,
    0xF180EB34,
    0x50717CBE,
    0xB5F6C6B2,
    0xDA7460CD,
    0x09939D54,
    0x22EA1ED4,
    0xE2471504,
    0x521BC98A,
    0xB8A762D0,
    0x5AC1348B,
    0xF4D02727,
    0x1999024A,
    0xC1766910,
    0xA8D66AD7,
    0xBE5E9001,
    0x620A8652,
    0xC57DB17C,
    0x00C29F52,
    0xAB739D77,
    0xA70C4AFA,
    0xDD921F01,
    0x10B9A6F0,
    0xA6824A4E,
    0xCFE4FFE3,
    0x74866A08,
    0x89998CAF,
    0x6CDEBE7B,
    0x8FFDAC50,
    0x9DF30B5C,
    0x4F2D9AE3,
    0xAC4032EF,
};

dh_para_t dh_para_rfc5114_2048_224[1] = {{
    2048,
    224,
    2048,
    (unsigned int *)p_rfc5114_2048_224_u32,
    (unsigned int *)p_h_rfc5114_2048_224_u32,
    (unsigned int *)p_n0_rfc5114_2048_224_u32,
    (unsigned int *)q_rfc5114_2048_224_u32,
    (unsigned int *)g_rfc5114_2048_224_u32,
}};

/**
 * @brief           Test DH key exchange with standard 2048-bit parameters
 * @return          0 if the test is successful, 1 otherwise.
 */
unsigned int dh_rfc5114_2048_224_std_test(void)
{
    unsigned char a_pri_key[] = {0x22, 0xE6, 0x26, 0x01, 0xDB, 0xFF, 0xD0, 0x67, 0x08, 0xA6, 0x80, 0xF7, 0x47, 0xF3,
                                 0x61, 0xF7, 0x6D, 0x8F, 0x4F, 0x72, 0x1A, 0x05, 0x48, 0xE4, 0x83, 0x29, 0x4B, 0x0C};
    unsigned char a_pub_key[] = {0x1B, 0x3A, 0x63, 0x45, 0x1B, 0xD8, 0x86, 0xE6, 0x99, 0xE6, 0x7B, 0x49, 0x4E, 0x28, 0x8B, 0xD7, 0xF8, 0xE0, 0xD3, 0x70, 0xBA, 0xDD, 0xA7, 0xA0,
                                 0xEF, 0xD2, 0xFD, 0xE7, 0xD8, 0xF6, 0x61, 0x45, 0xCC, 0x9F, 0x28, 0x04, 0x19, 0x97, 0x5E, 0xB8, 0x08, 0x87, 0x7C, 0x8A, 0x4C, 0x0C, 0x8E, 0x0B,
                                 0xD4, 0x8D, 0x4A, 0x54, 0x01, 0xEB, 0x1E, 0x87, 0x76, 0xBF, 0xEE, 0xE1, 0x34, 0xC0, 0x38, 0x31, 0xAC, 0x27, 0x3C, 0xD9, 0xD6, 0x35, 0xAB, 0x0C,
                                 0xE0, 0x06, 0xA4, 0x2A, 0x88, 0x7E, 0x3F, 0x52, 0xFB, 0x87, 0x66, 0xB6, 0x50, 0xF3, 0x80, 0x78, 0xBC, 0x8E, 0xE8, 0x58, 0x0C, 0xEF, 0xE2, 0x43,
                                 0x96, 0x8C, 0xFC, 0x4F, 0x8D, 0xC3, 0xDB, 0x08, 0x45, 0x54, 0x17, 0x1D, 0x41, 0xBF, 0x2E, 0x86, 0x1B, 0x7B, 0xB4, 0xD6, 0x9D, 0xD0, 0xE0, 0x1E,
                                 0xA3, 0x87, 0xCB, 0xAA, 0x5C, 0xA6, 0x72, 0xAF, 0xCB, 0xE8, 0xBD, 0xB9, 0xD6, 0x2D, 0x4C, 0xE1, 0x5F, 0x17, 0xDD, 0x36, 0xF9, 0x1E, 0xD1, 0xEE,
                                 0xDD, 0x65, 0xCA, 0x4A, 0x06, 0x45, 0x5C, 0xB9, 0x4C, 0xD4, 0x0A, 0x52, 0xEC, 0x36, 0x0E, 0x84, 0xB3, 0xC9, 0x26, 0xE2, 0x2C, 0x43, 0x80, 0xA3,
                                 0xBF, 0x30, 0x9D, 0x56, 0x84, 0x97, 0x68, 0xB7, 0xF5, 0x2C, 0xFD, 0xF6, 0x55, 0xFD, 0x05, 0x3A, 0x7E, 0xF7, 0x06, 0x97, 0x9E, 0x7E, 0x58, 0x06,
                                 0xB1, 0x7D, 0xFA, 0xE5, 0x3A, 0xD2, 0xA5, 0xBC, 0x56, 0x8E, 0xBB, 0x52, 0x9A, 0x7A, 0x61, 0xD6, 0x8D, 0x25, 0x6F, 0x8F, 0xC9, 0x7C, 0x07, 0x4A,
                                 0x86, 0x1D, 0x82, 0x7E, 0x2E, 0xBC, 0x8C, 0x61, 0x34, 0x55, 0x31, 0x15, 0xB7, 0x0E, 0x71, 0x03, 0x92, 0x0A, 0xA1, 0x6D, 0x85, 0xE5, 0x2B, 0xCB,
                                 0xAB, 0x8D, 0x78, 0x6A, 0x68, 0x17, 0x8F, 0xA8, 0xFF, 0x7C, 0x2F, 0x5C, 0x71, 0x64, 0x8D, 0x6F};
    unsigned char b_pri_key[] = {0x4F, 0xF3, 0xBC, 0x96, 0xC7, 0xFC, 0x6A, 0x6D, 0x71, 0xD3, 0xB3, 0x63, 0x80, 0x0A,
                                 0x7C, 0xDF, 0xEF, 0x6F, 0xC4, 0x1B, 0x44, 0x17, 0xEA, 0x15, 0x35, 0x3B, 0x75, 0x90};
    unsigned char b_pub_key[] = {0x4D, 0xCE, 0xE9, 0x92, 0xA9, 0x76, 0x2A, 0x13, 0xF2, 0xF8, 0x38, 0x44, 0xAD, 0x3D, 0x77, 0xEE, 0x0E, 0x31, 0xC9, 0x71, 0x8B, 0x3D, 0xB6, 0xC2,
                                 0x03, 0x5D, 0x39, 0x61, 0x18, 0x2C, 0x3E, 0x0B, 0xA2, 0x47, 0xEC, 0x41, 0x82, 0xD7, 0x60, 0xCD, 0x48, 0xD9, 0x95, 0x99, 0x97, 0x06, 0x22, 0xA1,
                                 0x88, 0x1B, 0xBA, 0x2D, 0xC8, 0x22, 0x93, 0x9C, 0x78, 0xC3, 0x91, 0x2C, 0x66, 0x61, 0xFA, 0x54, 0x38, 0xB2, 0x07, 0x66, 0x22, 0x2B, 0x75, 0xE2,
                                 0x4C, 0x2E, 0x3A, 0xD0, 0xC7, 0x28, 0x72, 0x36, 0x12, 0x95, 0x25, 0xEE, 0x15, 0xB5, 0xDD, 0x79, 0x98, 0xAA, 0x04, 0xC4, 0xA9, 0x69, 0x6C, 0xAC,
                                 0xD7, 0x17, 0x20, 0x83, 0xA9, 0x7A, 0x81, 0x66, 0x4E, 0xAD, 0x2C, 0x47, 0x9E, 0x44, 0x4E, 0x4C, 0x06, 0x54, 0xCC, 0x19, 0xE2, 0x8D, 0x77, 0x03,
                                 0xCE, 0xE8, 0xDA, 0xCD, 0x61, 0x26, 0xF5, 0xD6, 0x65, 0xEC, 0x52, 0xC6, 0x72, 0x55, 0xDB, 0x92, 0x01, 0x4B, 0x03, 0x7E, 0xB6, 0x21, 0xA2, 0xAC,
                                 0x8E, 0x36, 0x5D, 0xE0, 0x71, 0xFF, 0xC1, 0x40, 0x0A, 0xCF, 0x07, 0x7A, 0x12, 0x91, 0x3D, 0xD8, 0xDE, 0x89, 0x47, 0x34, 0x37, 0xAB, 0x7B, 0xA3,
                                 0x46, 0x74, 0x3C, 0x1B, 0x21, 0x5D, 0xD9, 0xC1, 0x21, 0x64, 0xA7, 0xE4, 0x05, 0x31, 0x18, 0xD1, 0x99, 0xBE, 0xC8, 0xEF, 0x6F, 0xC5, 0x61, 0x17,
                                 0x0C, 0x84, 0xC8, 0x7D, 0x10, 0xEE, 0x9A, 0x67, 0x4A, 0x1F, 0xA8, 0xFF, 0xE1, 0x3B, 0xDF, 0xBA, 0x1D, 0x44, 0xDE, 0x48, 0x94, 0x6D, 0x68, 0xDC,
                                 0x0C, 0xDD, 0x77, 0x76, 0x35, 0xA7, 0xAB, 0x5B, 0xFB, 0x1E, 0x4B, 0xB7, 0xB8, 0x56, 0xF9, 0x68, 0x27, 0x73, 0x4C, 0x18, 0x41, 0x38, 0xE9, 0x15,
                                 0xD9, 0xC3, 0x00, 0x2E, 0xBC, 0xE5, 0x31, 0x20, 0x54, 0x6A, 0x7E, 0x20, 0x02, 0x14, 0x2B, 0x6C};
    unsigned char std_key[] = {0x34, 0xD9, 0xBD, 0xDC, 0x1B, 0x42, 0x17, 0x6C, 0x31, 0x3F, 0xEA, 0x03, 0x4C, 0x21, 0x03, 0x4D, 0x07, 0x4A, 0x63, 0x13, 0xBB, 0x4E, 0xCD, 0xB3,
                               0x70, 0x3F, 0xFF, 0x42, 0x45, 0x67, 0xA4, 0x6B, 0xDF, 0x75, 0x53, 0x0E, 0xDE, 0x0A, 0x9D, 0xA5, 0x22, 0x9D, 0xE7, 0xD7, 0x67, 0x32, 0x28, 0x6C,
                               0xBC, 0x0F, 0x91, 0xDA, 0x4C, 0x3C, 0x85, 0x2F, 0xC0, 0x99, 0xC6, 0x79, 0x53, 0x1D, 0x94, 0xC7, 0x8A, 0xB0, 0x3D, 0x9D, 0xEC, 0xB0, 0xA4, 0xE4,
                               0xCA, 0x8B, 0x2B, 0xB4, 0x59, 0x1C, 0x40, 0x21, 0xCF, 0x8C, 0xE3, 0xA2, 0x0A, 0x54, 0x1D, 0x33, 0x99, 0x40, 0x17, 0xD0, 0x20, 0x0A, 0xE2, 0xC9,
                               0x51, 0x6E, 0x2F, 0xF5, 0x14, 0x57, 0x79, 0x26, 0x9E, 0x86, 0x2B, 0x0F, 0xB4, 0x74, 0xA2, 0xD5, 0x6D, 0xC3, 0x1E, 0xD5, 0x69, 0xA7, 0x70, 0x0B,
                               0x4C, 0x4A, 0xB1, 0x6B, 0x22, 0xA4, 0x55, 0x13, 0x53, 0x1E, 0xF5, 0x23, 0xD7, 0x12, 0x12, 0x07, 0x7B, 0x5A, 0x16, 0x9B, 0xDE, 0xFF, 0xAD, 0x7A,
                               0xD9, 0x60, 0x82, 0x84, 0xC7, 0x79, 0x5B, 0x6D, 0x5A, 0x51, 0x83, 0xB8, 0x70, 0x66, 0xDE, 0x17, 0xD8, 0xD6, 0x71, 0xC9, 0xEB, 0xD8, 0xEC, 0x89,
                               0x54, 0x4D, 0x45, 0xEC, 0x06, 0x15, 0x93, 0xD4, 0x42, 0xC6, 0x2A, 0xB9, 0xCE, 0x3B, 0x1C, 0xB9, 0x94, 0x3A, 0x1D, 0x23, 0xA5, 0xEA, 0x3B, 0xCF,
                               0x21, 0xA0, 0x14, 0x71, 0xE6, 0x7E, 0x00, 0x3E, 0x7F, 0x8A, 0x69, 0xC7, 0x28, 0xBE, 0x49, 0x0B, 0x2F, 0xC8, 0x8C, 0xFE, 0xB9, 0x2D, 0xB6, 0xA2,
                               0x15, 0xE5, 0xD0, 0x3C, 0x17, 0xC4, 0x64, 0xC9, 0xAC, 0x1A, 0x46, 0xE2, 0x03, 0xE1, 0x3F, 0x95, 0x29, 0x95, 0xFB, 0x03, 0xC6, 0x9D, 0x3C, 0xC4,
                               0x7F, 0xCB, 0x51, 0x0B, 0x69, 0x98, 0xFF, 0xD3, 0xAA, 0x6D, 0xE7, 0x3C, 0xF9, 0xF6, 0x38, 0x69};
    unsigned char pubkey[(2048 + 7) / 8];
    unsigned int ret;

    ret = dh_generate_pubkey_from_prikey(dh_para_rfc5114_2048_224, a_pri_key, pubkey);
    if ((DH_SUCCESS != ret) || memcmp_(pubkey, a_pub_key, (2048 + 7) / 8))
    {
        printf("\r\n generate A public key error, ret = %x", ret);
        fflush(stdout);
        print_buf_u8(pubkey, (2048 + 7) / 8, "A public key");
        return 1;
    }

    ret = dh_generate_pubkey_from_prikey(dh_para_rfc5114_2048_224, b_pri_key, pubkey);
    if ((DH_SUCCESS != ret) || memcmp_(pubkey, b_pub_key, (2048 + 7) / 8))
    {
        printf("\r\n generate B public key error, ret = %x", ret);
        fflush(stdout);
        print_buf_u8(pubkey, (2048 + 7) / 8, "A public key");
        return 1;
    }

    ret = dh_test_internal(dh_para_rfc5114_2048_224, a_pri_key, a_pub_key, b_pri_key, b_pub_key, std_key, "dhRFC5114(2048-224)");
    if (DH_SUCCESS != ret)
    {
        // printf("\r\n dh_test_internal error, ret = %x", ret);fflush(stdout);
        return 1;
    }

    printf("\r\n dhRFC5114(2048-224) standard data test success");
    fflush(stdout);

    return 0;
}
#endif

#if (DH_MAX_BIT_LEN >= 3072)
// data ref : RFC3526
// unsigned int little-endian
unsigned int p_rfc3526_3072_3071_u32[96] = {
    0xFFFFFFFF,
    0xFFFFFFFF,
    0xA93AD2CA,
    0x4B82D120,
    0xE0FD108E,
    0x43DB5BFC,
    0x74E5AB31,
    0x08E24FA0,
    0xBAD946E2,
    0x770988C0,
    0x7A615D6C,
    0xBBE11757,
    0x177B200C,
    0x521F2B18,
    0x3EC86A64,
    0xD8760273,
    0xD98A0864,
    0xF12FFA06,
    0x1AD2EE6B,
    0xCEE3D226,
    0x4A25619D,
    0x1E8C94E0,
    0xDB0933D7,
    0xABF5AE8C,
    0xA6E1E4C7,
    0xB3970F85,
    0x5D060C7D,
    0x8AEA7157,
    0x58DBEF0A,
    0xECFB8504,
    0xDF1CBA64,
    0xA85521AB,
    0x04507A33,
    0xAD33170D,
    0x8AAAC42D,
    0x15728E5A,
    0x98FA0510,
    0x15D22618,
    0xEA956AE5,
    0x3995497C,
    0x95581718,
    0xDE2BCBF6,
    0x6F4C52C9,
    0xB5C55DF0,
    0xEC07A28F,
    0x9B2783A2,
    0x180E8603,
    0xE39E772C,
    0x2E36CE3B,
    0x32905E46,
    0xCA18217C,
    0xF1746C08,
    0x4ABC9804,
    0x670C354E,
    0x7096966D,
    0x9ED52907,
    0x208552BB,
    0x1C62F356,
    0xDCA3AD96,
    0x83655D23,
    0xFD24CF5F,
    0x69163FA8,
    0x1C55D39A,
    0x98DA4836,
    0xA163BF05,
    0xC2007CB8,
    0xECE45B3D,
    0x49286651,
    0x7C4B1FE6,
    0xAE9F2411,
    0x5A899FA5,
    0xEE386BFB,
    0xF406B7ED,
    0x0BFF5CB6,
    0xA637ED6B,
    0xF44C42E9,
    0x625E7EC6,
    0xE485B576,
    0x6D51C245,
    0x4FE1356D,
    0xF25F1437,
    0x302B0A6D,
    0xCD3A431B,
    0xEF9519B3,
    0x8E3404DD,
    0x514A0879,
    0x3B139B22,
    0x020BBEA6,
    0x8A67CC74,
    0x29024E08,
    0x80DC1CD1,
    0xC4C6628B,
    0x2168C234,
    0xC90FDAA2,
    0xFFFFFFFF,
    0xFFFFFFFF,
};
unsigned int p_h_rfc3526_3072_3071_u32[96] = {
    0x38D241CD,
    0x2697CA91,
    0x60E7F138,
    0x3587F069,
    0xE5C1DB66,
    0x4F30B920,
    0xB15BA577,
    0x95823215,
    0x64894D96,
    0x4335AACB,
    0x3C6ED6A3,
    0xAE128402,
    0xFA8406AB,
    0xFC1187A5,
    0x15B17FFA,
    0x682AAB9A,
    0x26E335D7,
    0xBC2B64CF,
    0xABB0B76A,
    0x8AA61391,
    0xE41A52B2,
    0x1EF22571,
    0xA993D147,
    0x1D93075A,
    0xA77DEDDA,
    0xFEA5187F,
    0x443561C6,
    0xAF80D4B5,
    0x83DF2859,
    0xB186424B,
    0x8A59BC7F,
    0x1CAEFC18,
    0x1D18F0C8,
    0x1B9D0127,
    0xC3C0B3F4,
    0x3EFEF29D,
    0x08108C0C,
    0x785483C6,
    0x56E88B53,
    0x4F127682,
    0x38D6FCDD,
    0xBFD961D5,
    0x78024208,
    0xB41A05F0,
    0x563706FB,
    0x19CC8D59,
    0x6ECC4987,
    0x5A7795D8,
    0x439F12EB,
    0x9A678BF4,
    0xC043F99C,
    0x7CDA502E,
    0x61E37F74,
    0x0672A33D,
    0xEFC802AF,
    0x19C2883E,
    0x670D9C6F,
    0x7DED489E,
    0x2C4B8E90,
    0xA73D0103,
    0xD5965134,
    0x8C6CBD34,
    0xD85B0A83,
    0x77A5C747,
    0x16FD7568,
    0x109D099E,
    0xBC8D5E9E,
    0xA5DAF736,
    0x24B7E495,
    0x7139D0AB,
    0x5DA184D5,
    0x49CD9D70,
    0x571F2C1C,
    0x2276CB40,
    0xDC396086,
    0xAF0EC45C,
    0xC27FDD33,
    0xAA05DA05,
    0x67DB7EDC,
    0x9875D4C1,
    0x9FBF543F,
    0x5CAA6900,
    0xF28DE772,
    0xFA022336,
    0x648BEE54,
    0xFAE1CD10,
    0x69695C75,
    0x2AD479FE,
    0x5542F96C,
    0x84895A7C,
    0xE0669E0F,
    0xA332E8E3,
    0x31AD0295,
    0x44C4E4E4,
    0x51DF35DA,
    0x5AC8B4FB,
};
unsigned int p_n0_rfc3526_3072_3071_u32[1] = {0x00000001};
unsigned int q_rfc3526_3072_3071_u32[96] = {
    0xFFFFFFFF, 0x7FFFFFFF, 0x549D6965, 0x25C16890, 0x707E8847, 0xA1EDADFE, 0x3A72D598, 0x047127D0, 0x5D6CA371, 0x3B84C460, 0xBD30AEB6, 0x5DF08BAB, 0x0BBD9006, 0x290F958C,
    0x9F643532, 0x6C3B0139, 0x6CC50432, 0xF897FD03, 0x0D697735, 0xE771E913, 0x2512B0CE, 0x8F464A70, 0x6D8499EB, 0xD5FAD746, 0xD370F263, 0xD9CB87C2, 0xAE83063E, 0x457538AB,
    0x2C6DF785, 0x767DC282, 0xEF8E5D32, 0xD42A90D5, 0x82283D19, 0xD6998B86, 0x45556216, 0x0AB9472D, 0x4C7D0288, 0x8AE9130C, 0x754AB572, 0x1CCAA4BE, 0x4AAC0B8C, 0xEF15E5FB,
    0x37A62964, 0xDAE2AEF8, 0x7603D147, 0xCD93C1D1, 0x0C074301, 0xF1CF3B96, 0x171B671D, 0x19482F23, 0x650C10BE, 0x78BA3604, 0x255E4C02, 0xB3861AA7, 0xB84B4B36, 0xCF6A9483,
    0x1042A95D, 0x0E3179AB, 0xEE51D6CB, 0xC1B2AE91, 0x7E9267AF, 0x348B1FD4, 0x0E2AE9CD, 0xCC6D241B, 0x50B1DF82, 0xE1003E5C, 0xF6722D9E, 0x24943328, 0xBE258FF3, 0xD74F9208,
    0xAD44CFD2, 0xF71C35FD, 0x7A035BF6, 0x85FFAE5B, 0xD31BF6B5, 0x7A262174, 0x312F3F63, 0xF242DABB, 0xB6A8E122, 0xA7F09AB6, 0xF92F8A1B, 0x98158536, 0xE69D218D, 0xF7CA8CD9,
    0xC71A026E, 0x28A5043C, 0x1D89CD91, 0x0105DF53, 0x4533E63A, 0x94812704, 0xC06E0E68, 0x62633145, 0x10B4611A, 0xE487ED51, 0xFFFFFFFF, 0x7FFFFFFF};
unsigned int g_rfc3526_3072_3071_u32[1] = {2};

dh_para_t dh_para_rfc3526_3072_3071[1] = {{
    3072,
    3071,
    2,
    (unsigned int *)p_rfc3526_3072_3071_u32,
    (unsigned int *)p_h_rfc3526_3072_3071_u32,
    (unsigned int *)p_n0_rfc3526_3072_3071_u32,
    (unsigned int *)q_rfc3526_3072_3071_u32,
    (unsigned int *)g_rfc3526_3072_3071_u32,
}};

/**
 * @brief           Test DH key exchange with standard 3071-bit parameters
 * @return          0 if the test is successful, 1 otherwise.
 */
unsigned int dh_rfc3526_3072_3071_std_test(void)
{
    // test data is not from RFC3526
    unsigned char a_pri_key[] = {
        0x3D,
        0xC6,
        0x46,
        0x22,
        0x95,
        0xB6,
        0x1E,
        0x2D,
        0xCE,
        0x6B,
        0xDE,
        0xA0,
        0x25,
        0x58,
        0x85,
        0x80,
        0x3E,
        0xCC,
        0xBE,
        0xD6,
        0x2C,
        0xF5,
        0xD8,
        0xCA,
        0xCC,
        0x28,
        0x61,
        0x3F,
        0x88,
        0x05,
        0xA3,
        0x51,
        0xF5,
        0xB0,
        0x72,
        0x8F,
        0x86,
        0x73,
        0xE6,
        0x8C,
        0x2C,
        0x87,
        0xA2,
        0x31,
        0x2C,
        0x4F,
        0x43,
        0x77,
        0xB6,
        0x50,
        0xE1,
        0x32,
        0xCC,
        0x92,
        0xA3,
        0xE5,
        0xD6,
        0xD1,
        0xA1,
        0x71,
        0xB5,
        0xF5,
        0x59,
        0xF5,
        0x4C,
        0xF5,
        0xF4,
        0x8C,
        0x7A,
        0xAF,
        0x71,
        0x6D,
        0xC4,
        0x63,
        0xC7,
        0x2B,
        0x37,
        0xED,
        0xAF,
        0xBF,
        0x2A,
        0x41,
        0x6A,
        0x70,
        0xD2,
        0x4F,
        0xB7,
        0x35,
        0xC9,
        0x2B,
        0x85,
        0xCD,
        0x1C,
        0x46,
        0x57,
        0xFA,
        0x03,
        0x27,
        0x80,
        0x74,
        0xBB,
        0x1B,
        0x59,
        0xDE,
        0xDF,
        0x0E,
        0xC6,
        0x59,
        0x9C,
        0x52,
        0xA2,
        0x50,
        0xCB,
        0x78,
        0xF4,
        0x72,
        0x11,
        0xB6,
        0xB7,
        0xF1,
        0x92,
        0x16,
        0x30,
        0xED,
        0xCC,
        0xFE,
        0xD1,
        0xD1,
        0x84,
        0xC1,
        0xB1,
        0xBA,
        0xAD,
        0x18,
        0x70,
        0xB7,
        0x81,
        0xB6,
        0xAE,
        0x62,
        0x9E,
        0xB5,
        0x29,
        0xDC,
        0x9E,
        0xC0,
        0x8C,
        0x47,
        0x0D,
        0xDF,
        0xE1,
        0x8C,
        0x67,
        0x52,
        0x63,
        0xEB,
        0xD1,
        0x5E,
        0x5A,
        0xCA,
        0xCD,
        0x51,
        0x37,
        0xD8,
        0xFB,
        0xC5,
        0x1E,
        0x09,
        0x69,
        0x10,
        0xC8,
        0xC8,
        0xB1,
        0x09,
        0x52,
        0x88,
        0x71,
        0xEB,
        0x7A,
        0x24,
        0xD1,
        0xE9,
        0x72,
        0x94,
        0xDD,
        0x66,
        0x3A,
        0x48,
        0xFD,
        0x42,
        0xBF,
        0x2E,
        0xBA,
        0xD2,
        0x61,
        0xAD,
        0xDB,
        0x74,
        0x58,
        0x3B,
        0x88,
        0x1B,
        0x97,
        0x63,
        0x8D,
        0x4F,
        0x11,
        0x8E,
        0xB9,
        0x25,
        0xD8,
        0x3A,
        0xEC,
        0xB6,
        0xE1,
        0x48,
        0xBD,
        0x91,
        0x50,
        0xCD,
        0x42,
        0x97,
        0x3D,
        0xF3,
        0x02,
        0x67,
        0x84,
        0x27,
        0x00,
        0xFE,
        0x63,
        0xC5,
        0x6B,
        0xBF,
        0x41,
        0x4E,
        0x42,
        0x4F,
        0xE0,
        0xDF,
        0x87,
        0x04,
        0xC6,
        0xD1,
        0x38,
        0x29,
        0xE2,
        0x51,
        0xEE,
        0xBA,
        0x6C,
        0x80,
        0xFE,
        0xBA,
        0x49,
        0xB1,
        0xC8,
        0x06,
        0xF1,
        0xC9,
        0xA9,
        0xAE,
        0xA6,
        0x8D,
        0x42,
        0x95,
        0x49,
        0x72,
        0x4C,
        0x12,
        0xE1,
        0x36,
        0x2C,
        0xEE,
        0x11,
        0x46,
        0x3E,
        0x27,
        0x12,
        0xE0,
        0xB7,
        0x2E,
        0x6B,
        0xBB,
        0x53,
        0x1D,
        0xB9,
        0x5D,
        0xE8,
        0xF5,
        0x03,
        0x33,
        0x2D,
        0x9C,
        0x66,
        0x2E,
        0xCF,
        0x27,
        0x3B,
        0x1E,
        0xEC,
        0xFC,
        0xB5,
        0x1F,
        0x7D,
        0x55,
        0x93,
        0xC0,
        0xC0,
        0x04,
        0xFD,
        0x6F,
        0x92,
        0xAF,
        0x2C,
        0x02,
        0x25,
        0x03,
        0xA5,
        0x2C,
        0x02,
        0x28,
        0xE4,
        0xD0,
        0x08,
        0x69,
        0x02,
        0x45,
        0x24,
        0xB9,
        0x64,
        0x7D,
        0x76,
        0xD5,
        0x17,
        0x44,
        0x66,
        0xBA,
        0xC7,
        0xE9,
        0xB8,
        0x70,
        0xE5,
        0xB8,
        0x72,
        0x6E,
        0x43,
        0x5C,
        0x36,
        0xC6,
        0x71,
        0xD3,
        0x32,
        0xA2,
        0x8C,
        0xBF,
        0x2D,
        0xC6,
        0x2F,
        0xF5,
        0x0B,
        0xA1,
        0x20,
        0xA3,
        0xBF,
        0xBC,
        0x49,
        0x80,
        0xA0,
        0xA9,
        0x20,
        0x96,
        0x4E,
        0xAC,
        0xE9,
        0x34,
        0x96,
        0xAC,
        0xEF,
        0x4D,
        0x7F,
        0x49,
        0x74,
        0x47,
    };
    unsigned char a_pub_key[] = {
        0xA4,
        0xEC,
        0x51,
        0x0B,
        0x71,
        0x8D,
        0x1F,
        0xFB,
        0xE6,
        0x4E,
        0x15,
        0xD4,
        0xC2,
        0x02,
        0x7F,
        0xC3,
        0x08,
        0x5B,
        0x3F,
        0x8F,
        0x54,
        0xE8,
        0x2C,
        0xC5,
        0x41,
        0x6A,
        0xA1,
        0x39,
        0x07,
        0x7A,
        0x73,
        0xDE,
        0xE0,
        0xE7,
        0x8B,
        0x15,
        0xC8,
        0xC0,
        0x33,
        0xB7,
        0x18,
        0x8D,
        0x9F,
        0xB7,
        0x76,
        0xC8,
        0xB3,
        0x7E,
        0xA7,
        0xB1,
        0x57,
        0x68,
        0xC2,
        0x57,
        0xB9,
        0x0A,
        0xF5,
        0x38,
        0x06,
        0x03,
        0x1A,
        0x1B,
        0x28,
        0x28,
        0x27,
        0x25,
        0xB8,
        0x5B,
        0x99,
        0xD1,
        0xBB,
        0xFE,
        0xAB,
        0x9D,
        0x1D,
        0x86,
        0xD4,
        0xE8,
        0x64,
        0xCA,
        0xDB,
        0x94,
        0x54,
        0x24,
        0xF2,
        0x70,
        0xCB,
        0x8F,
        0x7C,
        0x90,
        0x76,
        0x05,
        0xE8,
        0xA5,
        0x0A,
        0x28,
        0xBD,
        0xAA,
        0x61,
        0x25,
        0x2D,
        0x8B,
        0x45,
        0x89,
        0x17,
        0xFE,
        0x0C,
        0x56,
        0x7D,
        0x4E,
        0xB0,
        0xA1,
        0x4D,
        0x4A,
        0xC4,
        0x4B,
        0xF4,
        0xD3,
        0xDE,
        0x97,
        0x19,
        0x4F,
        0x2F,
        0xF9,
        0xB4,
        0xA8,
        0x8E,
        0x8D,
        0x4F,
        0xA5,
        0xA0,
        0xDE,
        0xD9,
        0xFF,
        0xE8,
        0x83,
        0xCA,
        0xBA,
        0xDA,
        0x58,
        0xA1,
        0xFB,
        0xA1,
        0xAC,
        0x9E,
        0x94,
        0x1E,
        0x36,
        0xA7,
        0x66,
        0xD5,
        0xA8,
        0xE3,
        0x15,
        0x18,
        0x33,
        0x11,
        0x17,
        0x90,
        0xC8,
        0xDD,
        0x8A,
        0xAF,
        0x11,
        0x1E,
        0xE2,
        0x1E,
        0xAE,
        0x63,
        0x8C,
        0x89,
        0x41,
        0x8F,
        0xA5,
        0x52,
        0xED,
        0x59,
        0xD2,
        0x18,
        0xA8,
        0x94,
        0xEF,
        0x72,
        0xEA,
        0x20,
        0xA9,
        0xEF,
        0x46,
        0x7F,
        0xE0,
        0x09,
        0x26,
        0x32,
        0xA0,
        0xAA,
        0xFB,
        0x46,
        0xE2,
        0xF4,
        0xBE,
        0xE5,
        0x4A,
        0x09,
        0x89,
        0x5F,
        0x94,
        0x71,
        0x04,
        0xD1,
        0x91,
        0xAF,
        0x59,
        0xB0,
        0x1B,
        0xE9,
        0x03,
        0x14,
        0x89,
        0x3D,
        0x7C,
        0xFA,
        0xE2,
        0xDA,
        0xC2,
        0xA3,
        0xAE,
        0x54,
        0xD2,
        0x70,
        0xF5,
        0x5B,
        0x88,
        0x69,
        0xE4,
        0xEE,
        0x22,
        0x29,
        0x1C,
        0xB9,
        0x73,
        0x25,
        0x4D,
        0xE3,
        0x44,
        0x42,
        0x53,
        0x2B,
        0x76,
        0x9E,
        0x31,
        0xAE,
        0xE2,
        0x9F,
        0x93,
        0x3E,
        0x95,
        0x17,
        0xF7,
        0x17,
        0x09,
        0x96,
        0x38,
        0x2D,
        0xCC,
        0xEB,
        0x7D,
        0x64,
        0xF1,
        0x7F,
        0xA9,
        0x76,
        0x53,
        0xC3,
        0x61,
        0x30,
        0xA5,
        0x73,
        0x86,
        0x8C,
        0x52,
        0x62,
        0x00,
        0xF7,
        0x52,
        0x6B,
        0xD5,
        0xB2,
        0xCB,
        0x3A,
        0xBB,
        0x51,
        0xC2,
        0xDF,
        0x50,
        0x06,
        0x6B,
        0x43,
        0x7C,
        0xA5,
        0x07,
        0xF4,
        0xE1,
        0xDD,
        0xD6,
        0x23,
        0xDF,
        0x6F,
        0x4B,
        0x03,
        0xFF,
        0x27,
        0xCC,
        0x15,
        0x30,
        0x55,
        0xD7,
        0xF8,
        0x32,
        0xE3,
        0x6B,
        0x08,
        0x4F,
        0x62,
        0x36,
        0x62,
        0x17,
        0x6F,
        0x5A,
        0xB1,
        0x93,
        0x99,
        0x7F,
        0xE5,
        0x9D,
        0x67,
        0xC5,
        0xCB,
        0xA8,
        0xEE,
        0x07,
        0x7F,
        0xC5,
        0x4F,
        0x5A,
        0x18,
        0x27,
        0xF7,
        0x1C,
        0x0E,
        0xD5,
        0xD3,
        0x6E,
        0x26,
        0x9F,
        0x9A,
        0xD3,
        0xDD,
        0xBE,
        0xD0,
        0xF2,
        0x7F,
        0xCF,
        0x8E,
        0xE7,
        0x1A,
        0x4A,
        0xE1,
        0xBF,
        0x8F,
        0xFC,
        0x72,
        0x32,
        0x76,
        0xB8,
        0xDD,
        0x7F,
        0xC7,
        0xAB,
        0xC7,
        0xD5,
        0x7C,
        0x95,
        0x05,
        0x5F,
    };
    unsigned char b_pri_key[] = {
        0x7A,
        0x88,
        0xD6,
        0xB9,
        0x8C,
        0xA5,
        0x7B,
        0x2E,
        0x7E,
        0x7F,
        0x3D,
        0x34,
        0xE6,
        0x5A,
        0x1E,
        0xA3,
        0x23,
        0x2E,
        0x73,
        0xCB,
        0x8A,
        0x5B,
        0x6D,
        0x13,
        0xF3,
        0xB5,
        0xCD,
        0x41,
        0xB5,
        0xB5,
        0x36,
        0x44,
        0xB0,
        0xF7,
        0xCA,
        0xC4,
        0x3F,
        0x47,
        0x74,
        0x81,
        0xBF,
        0x23,
        0xB7,
        0x06,
        0x67,
        0x17,
        0x48,
        0x2C,
        0xA8,
        0xEC,
        0x3B,
        0x89,
        0x52,
        0x80,
        0xC4,
        0xC8,
        0xFA,
        0xC2,
        0x4E,
        0xFF,
        0x92,
        0x67,
        0x4F,
        0x97,
        0xCD,
        0xC0,
        0xA2,
        0xC2,
        0x28,
        0xD9,
        0xCD,
        0x7A,
        0xC7,
        0x97,
        0x4D,
        0xC4,
        0x13,
        0x4A,
        0xBF,
        0x4C,
        0x31,
        0x51,
        0x1D,
        0x6B,
        0xCF,
        0xAE,
        0x94,
        0x97,
        0xFE,
        0x57,
        0x25,
        0x6B,
        0x16,
        0x08,
        0x18,
        0xF3,
        0x7F,
        0xDD,
        0x05,
        0xCF,
        0x61,
        0x11,
        0x1B,
        0x57,
        0xD3,
        0xF6,
        0x51,
        0x30,
        0x2E,
        0xC7,
        0x61,
        0x1F,
        0xE5,
        0xA6,
        0x15,
        0xCF,
        0x7F,
        0x36,
        0x97,
        0xA1,
        0x7A,
        0x17,
        0x5A,
        0x69,
        0x6D,
        0xD9,
        0x13,
        0xBB,
        0x75,
        0x3C,
        0xD3,
        0x46,
        0x2E,
        0xD8,
        0x5A,
        0x66,
        0x38,
        0x3C,
        0x21,
        0xD3,
        0xAF,
        0xF5,
        0x44,
        0x8F,
        0x36,
        0x95,
        0xBB,
        0xFA,
        0x0F,
        0x00,
        0x08,
        0x1D,
        0xC2,
        0xAE,
        0x97,
        0x3A,
        0xBD,
        0xBA,
        0x1A,
        0x21,
        0xD8,
        0xC5,
        0x56,
        0x98,
        0x38,
        0x60,
        0x6F,
        0x69,
        0x1C,
        0xB5,
        0x0F,
        0x6F,
        0xAF,
        0xC2,
        0xB3,
        0x62,
        0x64,
        0xEA,
        0x59,
        0x6D,
        0xCC,
        0xC7,
        0xCF,
        0xA4,
        0x24,
        0x50,
        0xE9,
        0x59,
        0xB5,
        0x26,
        0xEB,
        0x6B,
        0x3C,
        0x6C,
        0x0F,
        0x53,
        0x3E,
        0x69,
        0x2F,
        0x72,
        0xC3,
        0xB5,
        0x39,
        0x58,
        0xBC,
        0xF8,
        0xFA,
        0xCA,
        0x63,
        0xE8,
        0x88,
        0xF8,
        0xA1,
        0xF2,
        0xF2,
        0x7B,
        0x5F,
        0x4F,
        0x65,
        0x18,
        0x39,
        0x6C,
        0xE5,
        0xE9,
        0x1D,
        0x02,
        0x5F,
        0x32,
        0xFE,
        0x3A,
        0x29,
        0x33,
        0x44,
        0xA4,
        0xCE,
        0xC9,
        0xBA,
        0xC8,
        0x96,
        0xA3,
        0xA7,
        0x1E,
        0x52,
        0x35,
        0xE9,
        0x55,
        0xA8,
        0x79,
        0x50,
        0x00,
        0xCA,
        0x8C,
        0xAF,
        0x8A,
        0x95,
        0x94,
        0x1C,
        0xAD,
        0xDF,
        0x3F,
        0x4D,
        0xE8,
        0xFA,
        0x2C,
        0x66,
        0x7E,
        0x30,
        0xD9,
        0xA1,
        0x99,
        0xFC,
        0x67,
        0x9F,
        0xB5,
        0x45,
        0x33,
        0xCB,
        0x46,
        0xDC,
        0x1C,
        0x97,
        0x57,
        0x3C,
        0x12,
        0x5C,
        0xCB,
        0xCA,
        0xF8,
        0x92,
        0x3D,
        0xCE,
        0xF7,
        0x2C,
        0x64,
        0x9D,
        0x76,
        0xC2,
        0xBC,
        0xE1,
        0x2D,
        0x93,
        0xAB,
        0x9F,
        0xA4,
        0x7D,
        0xB8,
        0xA0,
        0xD4,
        0x82,
        0x69,
        0x84,
        0x56,
        0x62,
        0x90,
        0xA8,
        0xA3,
        0x26,
        0x80,
        0x00,
        0xE0,
        0x92,
        0x5F,
        0xF5,
        0xD9,
        0x4D,
        0xFC,
        0x61,
        0xD3,
        0xE0,
        0xB4,
        0x6D,
        0xE2,
        0xD4,
        0x51,
        0x04,
        0x96,
        0x72,
        0x61,
        0x5F,
        0xD8,
        0x5C,
        0x5A,
        0x08,
        0x53,
        0xA8,
        0xAA,
        0x75,
        0xE5,
        0x68,
        0xBD,
        0x28,
        0xC9,
        0x98,
        0x1D,
        0xAF,
        0x72,
        0xBC,
        0xD0,
        0x7D,
        0xCD,
        0x75,
        0xD1,
        0xD2,
        0xCB,
        0xF0,
        0x71,
        0x06,
        0x45,
        0x4C,
        0xF7,
        0xA8,
        0x91,
        0x3F,
        0x6C,
        0x9C,
        0x7E,
        0xD6,
        0xA7,
        0x4A,
        0xDB,
        0xA3,
        0x4A,
        0xB4,
        0x0D,
    };
    unsigned char b_pub_key[] = {
        0xC5,
        0x08,
        0xB2,
        0xB4,
        0x87,
        0x7B,
        0x97,
        0x0B,
        0x3F,
        0x45,
        0x07,
        0x0A,
        0xC0,
        0x71,
        0xBA,
        0x5E,
        0xF7,
        0x9D,
        0xC4,
        0x2F,
        0xE2,
        0xD2,
        0x9F,
        0x4D,
        0x63,
        0xF1,
        0xB1,
        0xF0,
        0x0C,
        0xC2,
        0xE2,
        0xFD,
        0xE4,
        0x18,
        0xA2,
        0xCE,
        0x6D,
        0xC7,
        0x52,
        0xB7,
        0x79,
        0x1E,
        0x89,
        0x7D,
        0xCE,
        0x6E,
        0x73,
        0x00,
        0x86,
        0x9E,
        0x01,
        0x61,
        0x7E,
        0x0B,
        0x4D,
        0x32,
        0xC3,
        0xB5,
        0x3A,
        0xFA,
        0xB8,
        0xF1,
        0xC8,
        0xBF,
        0xD6,
        0xAA,
        0x06,
        0x2D,
        0x1A,
        0x11,
        0x9A,
        0x19,
        0x65,
        0xF5,
        0x21,
        0x2C,
        0xC4,
        0xAF,
        0xD3,
        0x25,
        0xDA,
        0xBD,
        0xD7,
        0xB5,
        0x5A,
        0xC4,
        0x7A,
        0xF2,
        0xE3,
        0x42,
        0x35,
        0x4A,
        0x43,
        0x53,
        0xB7,
        0x16,
        0x61,
        0x90,
        0x08,
        0x86,
        0xDA,
        0x80,
        0x09,
        0xA8,
        0x75,
        0x7C,
        0x27,
        0x91,
        0x06,
        0x69,
        0xC4,
        0x3E,
        0x4B,
        0x84,
        0xB9,
        0x4D,
        0x43,
        0x60,
        0xB7,
        0xFD,
        0xC3,
        0x05,
        0x14,
        0x45,
        0xA3,
        0xD4,
        0xA1,
        0x08,
        0x9D,
        0x76,
        0x7E,
        0x8F,
        0x2E,
        0x87,
        0xC6,
        0x93,
        0x04,
        0x21,
        0xFB,
        0xB6,
        0xEE,
        0x90,
        0xB7,
        0x3B,
        0x62,
        0x9A,
        0x3B,
        0xA3,
        0x0B,
        0xB9,
        0xE5,
        0x85,
        0xDB,
        0x78,
        0xE4,
        0x27,
        0x08,
        0x1F,
        0x21,
        0xD6,
        0xBD,
        0xC7,
        0x19,
        0x40,
        0x3E,
        0xE0,
        0x2E,
        0x14,
        0x7A,
        0x9C,
        0x00,
        0x03,
        0x32,
        0x25,
        0x11,
        0xAE,
        0x79,
        0xDC,
        0x65,
        0xC5,
        0x65,
        0x01,
        0x40,
        0x0E,
        0x4F,
        0xBA,
        0x23,
        0x40,
        0x1D,
        0x64,
        0xDA,
        0x2E,
        0x71,
        0x36,
        0xAE,
        0xED,
        0xCC,
        0x7B,
        0xD7,
        0x97,
        0xD3,
        0x45,
        0xEC,
        0xEF,
        0x75,
        0xCD,
        0xE1,
        0xE6,
        0xAD,
        0x4C,
        0x93,
        0x24,
        0x4E,
        0xEF,
        0x1B,
        0xA9,
        0x06,
        0xEB,
        0xCD,
        0xC7,
        0xB0,
        0xED,
        0xE3,
        0x23,
        0x1C,
        0xD3,
        0xB0,
        0x4A,
        0x0B,
        0x21,
        0x2D,
        0xA2,
        0xBC,
        0xC2,
        0x21,
        0xE9,
        0x02,
        0x06,
        0x51,
        0xFB,
        0xB5,
        0x57,
        0xAC,
        0xAF,
        0x93,
        0x5F,
        0x84,
        0x7F,
        0xEC,
        0xF9,
        0x45,
        0x85,
        0x6C,
        0x8F,
        0x45,
        0x90,
        0x0F,
        0x66,
        0x9C,
        0xDC,
        0xCA,
        0x89,
        0x85,
        0x16,
        0x8E,
        0x0F,
        0x86,
        0x9C,
        0xFC,
        0x92,
        0x14,
        0x01,
        0x21,
        0x16,
        0xC4,
        0x99,
        0x3E,
        0x10,
        0xF9,
        0x6A,
        0x19,
        0x97,
        0x6F,
        0x0E,
        0xD6,
        0x7E,
        0x9E,
        0x41,
        0xCA,
        0x1B,
        0x9E,
        0x40,
        0x58,
        0x6D,
        0x23,
        0x2B,
        0x46,
        0xCF,
        0xCA,
        0x33,
        0x35,
        0x8D,
        0x21,
        0xE6,
        0x50,
        0x26,
        0x85,
        0xA4,
        0x3F,
        0x1D,
        0xEF,
        0xDF,
        0xAF,
        0x05,
        0xA6,
        0x2E,
        0x29,
        0xF2,
        0x08,
        0x6D,
        0x45,
        0x6F,
        0xBC,
        0x78,
        0xEC,
        0x30,
        0x61,
        0xA4,
        0x6B,
        0xC0,
        0x72,
        0xC9,
        0x4F,
        0xB8,
        0x9B,
        0xC8,
        0x54,
        0xE6,
        0x80,
        0x82,
        0x5B,
        0xF9,
        0xB1,
        0x65,
        0x92,
        0x33,
        0x3C,
        0x95,
        0x22,
        0x4C,
        0x36,
        0xE1,
        0xD3,
        0x8F,
        0x2E,
        0x56,
        0x72,
        0x30,
        0xAE,
        0xF1,
        0xA2,
        0xA7,
        0xA6,
        0xDB,
        0x18,
        0xC2,
        0x74,
        0x78,
        0xDB,
        0x41,
        0x73,
        0x8D,
        0x3F,
        0x5B,
        0x2E,
        0xB1,
        0x22,
        0x8A,
        0xB2,
        0x58,
        0x80,
        0xDA,
        0x7F,
        0xDC,
    };
    unsigned char std_key[] = {
        0x00,
        0xA3,
        0xE3,
        0x4C,
        0xAB,
        0xAB,
        0x51,
        0x84,
        0x6A,
        0x27,
        0x44,
        0x05,
        0x15,
        0x79,
        0x0B,
        0xC9,
        0x43,
        0xDD,
        0xC2,
        0xF8,
        0xF0,
        0x34,
        0x1B,
        0x45,
        0xBC,
        0x17,
        0x48,
        0xF2,
        0xE3,
        0x26,
        0xC6,
        0xC9,
        0x32,
        0xDE,
        0xB6,
        0x7A,
        0xB7,
        0xCD,
        0x29,
        0xCD,
        0x18,
        0x4A,
        0x4A,
        0x40,
        0x8B,
        0x2E,
        0x29,
        0x04,
        0x4E,
        0xA3,
        0xBD,
        0x59,
        0x9D,
        0xEF,
        0x25,
        0xBC,
        0xF6,
        0x2A,
        0x6D,
        0xCD,
        0xEF,
        0x93,
        0x79,
        0x2E,
        0x4A,
        0xB3,
        0x10,
        0x86,
        0xD1,
        0x87,
        0xFC,
        0xD3,
        0xF6,
        0x72,
        0x78,
        0x2C,
        0xBE,
        0x57,
        0x53,
        0xEF,
        0x66,
        0xA6,
        0xC3,
        0x23,
        0x80,
        0xA5,
        0xE5,
        0xB4,
        0xAB,
        0xF0,
        0xBE,
        0x3E,
        0x36,
        0xC6,
        0x98,
        0xD6,
        0xBA,
        0xD1,
        0xDE,
        0x99,
        0x52,
        0x94,
        0xE8,
        0xFE,
        0x22,
        0x84,
        0x5D,
        0x7F,
        0x73,
        0x37,
        0x5B,
        0x1E,
        0x09,
        0x66,
        0x29,
        0x99,
        0xCB,
        0xC8,
        0xDA,
        0x19,
        0xE6,
        0x41,
        0x62,
        0xB1,
        0xA7,
        0xF2,
        0xE8,
        0xFB,
        0xEE,
        0xB2,
        0xA5,
        0x05,
        0xDB,
        0xE4,
        0x1F,
        0xCC,
        0x09,
        0xBA,
        0x60,
        0xFB,
        0x9D,
        0x0A,
        0x5A,
        0x94,
        0xAB,
        0x3E,
        0x87,
        0x35,
        0xE7,
        0x85,
        0x3A,
        0x15,
        0x93,
        0xC9,
        0x75,
        0x7A,
        0xAD,
        0xD4,
        0xB8,
        0x59,
        0x53,
        0x06,
        0xE0,
        0x80,
        0x6B,
        0x51,
        0xA5,
        0xC8,
        0x04,
        0x51,
        0x4B,
        0xDA,
        0xE5,
        0xD0,
        0x7A,
        0xB3,
        0x06,
        0x30,
        0x62,
        0xDD,
        0x30,
        0xD7,
        0x5F,
        0xB8,
        0x3A,
        0xC0,
        0x6B,
        0x4B,
        0xC7,
        0xD8,
        0x00,
        0xF4,
        0x03,
        0xFB,
        0x57,
        0xF3,
        0xA0,
        0xFD,
        0x50,
        0xAF,
        0x77,
        0x26,
        0x6A,
        0xF3,
        0x4E,
        0x82,
        0xB6,
        0xEA,
        0xCE,
        0x77,
        0x4E,
        0x55,
        0x39,
        0x36,
        0x13,
        0x43,
        0x87,
        0x76,
        0xD9,
        0xF8,
        0x32,
        0x15,
        0xE2,
        0x2C,
        0xDB,
        0x65,
        0x70,
        0xFC,
        0x30,
        0xEA,
        0x55,
        0x6D,
        0x17,
        0xDA,
        0x18,
        0x1D,
        0x54,
        0x15,
        0x6D,
        0x04,
        0x48,
        0xE9,
        0xAE,
        0xF5,
        0x61,
        0xED,
        0xF2,
        0xF6,
        0x69,
        0x6F,
        0xE2,
        0xFF,
        0x59,
        0x1F,
        0x9A,
        0x5C,
        0x17,
        0x69,
        0xC8,
        0x50,
        0x64,
        0x26,
        0x77,
        0x31,
        0xA7,
        0x50,
        0x02,
        0x6D,
        0xD3,
        0x85,
        0xDD,
        0x36,
        0xD8,
        0xE5,
        0x05,
        0x50,
        0x0F,
        0x1D,
        0xC2,
        0xB8,
        0x57,
        0xAC,
        0x9F,
        0xF9,
        0x2B,
        0xB0,
        0x97,
        0xE8,
        0xEC,
        0x6E,
        0x90,
        0xCA,
        0xD1,
        0x8F,
        0xB4,
        0x7F,
        0x56,
        0xEE,
        0x4B,
        0x4E,
        0x73,
        0xD5,
        0xDE,
        0x73,
        0x57,
        0x2A,
        0x0D,
        0xC8,
        0x79,
        0x55,
        0x34,
        0x5D,
        0xD5,
        0x57,
        0xB8,
        0x4A,
        0xE7,
        0x7A,
        0x2E,
        0x6C,
        0x92,
        0x0D,
        0xD6,
        0x8B,
        0xEE,
        0x86,
        0x28,
        0xC1,
        0xB0,
        0x30,
        0xEA,
        0xB7,
        0xDB,
        0x86,
        0xD5,
        0xA0,
        0x2B,
        0xE2,
        0x84,
        0x1F,
        0xE4,
        0x09,
        0xD9,
        0xFD,
        0xC2,
        0x61,
        0xD9,
        0x9D,
        0xA1,
        0x1C,
        0x64,
        0x5E,
        0xBB,
        0xEA,
        0x7C,
        0x14,
        0x13,
        0x07,
        0x6E,
        0xA5,
        0x9D,
        0x34,
        0x05,
        0xFA,
        0x8C,
        0x7B,
        0xA8,
        0xB1,
        0x87,
        0xD1,
        0xA0,
        0x5D,
        0xD8,
        0xFB,
        0x86,
        0x8A,
        0xBC,
        0x84,
        0xC1,
        0x38,
        0x1C,
        0x6F,
        0x67,
        0xE0,
    };
    unsigned char pubkey[(3072 + 7) / 8];
    unsigned int ret;

    ret = dh_generate_pubkey_from_prikey(dh_para_rfc3526_3072_3071, a_pri_key, pubkey);
    if ((DH_SUCCESS != ret) || memcmp_(pubkey, a_pub_key, (3072 + 7) / 8))
    {
        printf("\r\n generate A public key error, ret = %x", ret);
        fflush(stdout);
        print_buf_u8(pubkey, (3072 + 7) / 8, "A public key");
        return 1;
    }

    ret = dh_generate_pubkey_from_prikey(dh_para_rfc3526_3072_3071, b_pri_key, pubkey);
    if ((DH_SUCCESS != ret) || memcmp_(pubkey, b_pub_key, (3072 + 7) / 8))
    {
        printf("\r\n generate B public key error, ret = %x", ret);
        fflush(stdout);
        print_buf_u8(pubkey, (3072 + 7) / 8, "A public key");
        return 1;
    }

    ret = dh_test_internal(dh_para_rfc3526_3072_3071, a_pri_key, a_pub_key, b_pri_key, b_pub_key, std_key, "dhRFC3526(3072-3071)");
    if (DH_SUCCESS != ret)
    {
        // printf("\r\n dh_test_internal error, ret = %x", ret);fflush(stdout);
        return 1;
    }

    printf("\r\n dhRFC3526(3072-3071) standard data test success");
    fflush(stdout);

    return 0;
}
#endif

#if (DH_MAX_BIT_LEN >= 4096)
// data ref : RFC3526
// unsigned int little-endian
unsigned int p_rfc3526_4096_4095_u32[128] = {
    0xFFFFFFFF,
    0xFFFFFFFF,
    0x34063199,
    0x4DF435C9,
    0x90A6C08F,
    0x86FFB7DC,
    0x8D8FDDC1,
    0x93B4EA98,
    0xD5B05AA9,
    0xD0069127,
    0x2170481C,
    0xB81BDD76,
    0xCEE2D7AF,
    0x1F612970,
    0x515BE7ED,
    0x233BA186,
    0xA090C3A2,
    0x99B2964F,
    0x4E6BC05D,
    0x287C5947,
    0x1FBECAA6,
    0x2E8EFC14,
    0x04DE8EF9,
    0xDBBBC2DB,
    0x2AD44CE8,
    0x2583E9CA,
    0xB6150BDA,
    0x1A946834,
    0x6AF4E23C,
    0x99C32718,
    0xBDBA5B26,
    0x88719A10,
    0xA787E6D7,
    0x1A723C12,
    0xA9210801,
    0x4B82D120,
    0xE0FD108E,
    0x43DB5BFC,
    0x74E5AB31,
    0x08E24FA0,
    0xBAD946E2,
    0x770988C0,
    0x7A615D6C,
    0xBBE11757,
    0x177B200C,
    0x521F2B18,
    0x3EC86A64,
    0xD8760273,
    0xD98A0864,
    0xF12FFA06,
    0x1AD2EE6B,
    0xCEE3D226,
    0x4A25619D,
    0x1E8C94E0,
    0xDB0933D7,
    0xABF5AE8C,
    0xA6E1E4C7,
    0xB3970F85,
    0x5D060C7D,
    0x8AEA7157,
    0x58DBEF0A,
    0xECFB8504,
    0xDF1CBA64,
    0xA85521AB,
    0x04507A33,
    0xAD33170D,
    0x8AAAC42D,
    0x15728E5A,
    0x98FA0510,
    0x15D22618,
    0xEA956AE5,
    0x3995497C,
    0x95581718,
    0xDE2BCBF6,
    0x6F4C52C9,
    0xB5C55DF0,
    0xEC07A28F,
    0x9B2783A2,
    0x180E8603,
    0xE39E772C,
    0x2E36CE3B,
    0x32905E46,
    0xCA18217C,
    0xF1746C08,
    0x4ABC9804,
    0x670C354E,
    0x7096966D,
    0x9ED52907,
    0x208552BB,
    0x1C62F356,
    0xDCA3AD96,
    0x83655D23,
    0xFD24CF5F,
    0x69163FA8,
    0x1C55D39A,
    0x98DA4836,
    0xA163BF05,
    0xC2007CB8,
    0xECE45B3D,
    0x49286651,
    0x7C4B1FE6,
    0xAE9F2411,
    0x5A899FA5,
    0xEE386BFB,
    0xF406B7ED,
    0x0BFF5CB6,
    0xA637ED6B,
    0xF44C42E9,
    0x625E7EC6,
    0xE485B576,
    0x6D51C245,
    0x4FE1356D,
    0xF25F1437,
    0x302B0A6D,
    0xCD3A431B,
    0xEF9519B3,
    0x8E3404DD,
    0x514A0879,
    0x3B139B22,
    0x020BBEA6,
    0x8A67CC74,
    0x29024E08,
    0x80DC1CD1,
    0xC4C6628B,
    0x2168C234,
    0xC90FDAA2,
    0xFFFFFFFF,
    0xFFFFFFFF,
};
unsigned int p_h_rfc3526_4096_4095_u32[128] = {
    0xCC03AA20,
    0xC14AB0DD,
    0xB30E9B12,
    0x8A1AC024,
    0x067E82B1,
    0xFA8F75F0,
    0x52074F19,
    0x37BF90FE,
    0x41C4F82B,
    0x55EA6F75,
    0xD97AC40A,
    0xB850DE95,
    0x7A17FB04,
    0x3549C577,
    0x230B2DFE,
    0x2A434CEB,
    0x7ED36C41,
    0x524E7C7A,
    0x1C1E467C,
    0xE4404092,
    0x04A636F7,
    0xA796D182,
    0x352D408C,
    0xC9C77F0C,
    0x98F001DB,
    0x51E75D99,
    0x4A612A18,
    0x8267537D,
    0x3E9EBD87,
    0x912A0491,
    0xCCF85F34,
    0x2E52989E,
    0xD7CE25D0,
    0xD203A9E0,
    0x734810F7,
    0x53C44FAB,
    0xB21E6B3D,
    0x20BD72B9,
    0x1296EF6A,
    0x62D21877,
    0x72C8D989,
    0x8563215F,
    0xEB4EEFD4,
    0x04BA044A,
    0x63A9315D,
    0xAE01E0F3,
    0xCB441F59,
    0x5F666146,
    0xFFB7A9A9,
    0xE60C6EFD,
    0x23CEF785,
    0x6C7951A5,
    0x20E739F4,
    0x09954843,
    0x9B51C1EF,
    0xFDC65A26,
    0x2A4B1A67,
    0xC93919D1,
    0x50C8953A,
    0xB18A9EF1,
    0x3FB8CF61,
    0x1D7D37A2,
    0x6E8452D9,
    0x46BDB733,
    0xDA60E392,
    0x8BD70562,
    0x787A8278,
    0x4F024193,
    0xC2B3E7E2,
    0xCA06DA91,
    0xF827DE84,
    0x8FB4832E,
    0x8E25F142,
    0x7E2C75A5,
    0x90DACF1A,
    0x34720869,
    0xE9F80A5F,
    0xE8105464,
    0x8BE2C91D,
    0xB616D6FA,
    0x5C7DC9C2,
    0xF1D27D0B,
    0x8E54806B,
    0x9E10FDE2,
    0x638F4566,
    0xE4FCCF1D,
    0x41058639,
    0x6C09060D,
    0x7411402D,
    0xC28A61D4,
    0x23864714,
    0x67DE8FA0,
    0x2929B90C,
    0x91A4F557,
    0x3CDD1196,
    0xBEACD46F,
    0x9D381CC5,
    0xA89D1DCD,
    0x259E080F,
    0xCB225176,
    0x0188D84C,
    0x18C3DCE2,
    0xF798DA6A,
    0x91F30C52,
    0x22C39F34,
    0x3AD36FD8,
    0x6EC9FCD3,
    0xFEA80D9A,
    0xBD9F048C,
    0xF3E56CC2,
    0x7F6F604F,
    0x70B56F52,
    0x3ED73A2F,
    0x5401EA4F,
    0x7A674BD5,
    0x526A653A,
    0xAD47527E,
    0x4C2DE67D,
    0x62059F1F,
    0xAA7FBD95,
    0x339EBC93,
    0xF8B11725,
    0x9931D78D,
    0xB7B768C8,
    0xB78FDAA9,
    0xE65BCC3A,
    0xE280DB0B,
    0x3DA97659,
};
unsigned int p_n0_rfc3526_4096_4095_u32[1] = {0x00000001};
unsigned int q_rfc3526_4096_4095_u32[128] = {
    0xFFFFFFFF, 0xFFFFFFFF, 0x9A0318CC, 0xA6FA1AE4, 0x48536047, 0xC37FDBEE, 0x46C7EEE0, 0xC9DA754C, 0xEAD82D54, 0x68034893, 0x10B8240E, 0xDC0DEEBB, 0x67716BD7,
    0x8FB094B8, 0x28ADF3F6, 0x119DD0C3, 0xD04861D1, 0xCCD94B27, 0xA735E02E, 0x143E2CA3, 0x0FDF6553, 0x97477E0A, 0x826F477C, 0x6DDDE16D, 0x156A2674, 0x12C1F4E5,
    0x5B0A85ED, 0x0D4A341A, 0x357A711E, 0x4CE1938C, 0x5EDD2D93, 0xC438CD08, 0x53C3F36B, 0x8D391E09, 0x54908400, 0x25C16890, 0x707E8847, 0xA1EDADFE, 0x3A72D598,
    0x047127D0, 0x5D6CA371, 0x3B84C460, 0xBD30AEB6, 0x5DF08BAB, 0x0BBD9006, 0x290F958C, 0x9F643532, 0x6C3B0139, 0x6CC50432, 0xF897FD03, 0x0D697735, 0xE771E913,
    0x2512B0CE, 0x8F464A70, 0x6D8499EB, 0xD5FAD746, 0xD370F263, 0xD9CB87C2, 0xAE83063E, 0x457538AB, 0x2C6DF785, 0x767DC282, 0xEF8E5D32, 0xD42A90D5, 0x82283D19,
    0xD6998B86, 0x45556216, 0x0AB9472D, 0x4C7D0288, 0x8AE9130C, 0x754AB572, 0x1CCAA4BE, 0x4AAC0B8C, 0xEF15E5FB, 0x37A62964, 0xDAE2AEF8, 0x7603D147, 0xCD93C1D1,
    0x0C074301, 0xF1CF3B96, 0x171B671D, 0x19482F23, 0x650C10BE, 0x78BA3604, 0x255E4C02, 0xB3861AA7, 0xB84B4B36, 0xCF6A9483, 0x1042A95D, 0x0E3179AB, 0xEE51D6CB,
    0xC1B2AE91, 0x7E9267AF, 0x348B1FD4, 0x0E2AE9CD, 0xCC6D241B, 0x50B1DF82, 0xE1003E5C, 0xF6722D9E, 0x24943328, 0xBE258FF3, 0xD74F9208, 0xAD44CFD2, 0xF71C35FD,
    0x7A035BF6, 0x85FFAE5B, 0xD31BF6B5, 0x7A262174, 0x312F3F63, 0xF242DABB, 0xB6A8E122, 0xA7F09AB6, 0xF92F8A1B, 0x98158536, 0xE69D218D, 0xF7CA8CD9, 0xC71A026E,
    0x28A5043C, 0x1D89CD91, 0x0105DF53, 0x4533E63A, 0x94812704, 0xC06E0E68, 0x62633145, 0x10B4611A, 0xE487ED51, 0xFFFFFFFF, 0x7FFFFFFF};
unsigned int g_rfc3526_4096_4095_u32[1] = {2};

dh_para_t dh_para_rfc3526_4096_4095[1] = {{
    4096,
    4095,
    2,
    (unsigned int *)p_rfc3526_4096_4095_u32,
    (unsigned int *)p_h_rfc3526_4096_4095_u32,
    (unsigned int *)p_n0_rfc3526_4096_4095_u32,
    (unsigned int *)q_rfc3526_4096_4095_u32,
    (unsigned int *)g_rfc3526_4096_4095_u32,
}};

/**
 * @brief           Test DH key exchange with standard 2048-4096 parameters
 * @return          0 if the test is successful, 1 otherwise.
 */
unsigned int dh_rfc3526_4096_4095_std_test(void)
{
    // test data is not from RFC3526
    unsigned char a_pri_key[] = {
        0x6E,
        0x47,
        0x55,
        0x15,
        0x7C,
        0xF3,
        0xEC,
        0xDA,
        0xF7,
        0x3C,
        0x45,
        0xFD,
        0x92,
        0x23,
        0x14,
        0xFD,
        0x9E,
        0xAE,
        0x26,
        0xC6,
        0x8A,
        0x2E,
        0xBF,
        0x3B,
        0xDE,
        0x4A,
        0x49,
        0x99,
        0x65,
        0xDE,
        0xA1,
        0x16,
        0x10,
        0x29,
        0x3A,
        0x4D,
        0xC6,
        0x4F,
        0x35,
        0xC3,
        0x60,
        0x20,
        0x95,
        0x34,
        0x82,
        0x2C,
        0x7F,
        0x99,
        0x02,
        0x19,
        0xA9,
        0xF3,
        0x58,
        0x2B,
        0xDF,
        0x71,
        0x27,
        0xDE,
        0xCF,
        0xB2,
        0x78,
        0x50,
        0x84,
        0x7D,
        0xFF,
        0xBA,
        0x2B,
        0xDC,
        0xD9,
        0xE1,
        0xE2,
        0x63,
        0x3B,
        0xF5,
        0xF3,
        0x7F,
        0xE6,
        0x73,
        0xB9,
        0xEA,
        0x24,
        0x11,
        0xAA,
        0x11,
        0x05,
        0xF2,
        0x26,
        0xA1,
        0x55,
        0x2A,
        0x14,
        0xBE,
        0x91,
        0x6A,
        0xC7,
        0xF9,
        0x4E,
        0xAA,
        0x11,
        0xA2,
        0x80,
        0xAD,
        0x15,
        0xF0,
        0xCD,
        0xFF,
        0x64,
        0x22,
        0x78,
        0xB5,
        0xE2,
        0x25,
        0x41,
        0xDB,
        0xAB,
        0x68,
        0x4C,
        0x7B,
        0x82,
        0xB3,
        0x41,
        0xB7,
        0x08,
        0xB0,
        0x17,
        0x58,
        0xD9,
        0x38,
        0x5C,
        0x85,
        0x59,
        0x8F,
        0xF3,
        0x6B,
        0x66,
        0x34,
        0x2C,
        0xBD,
        0x49,
        0xF2,
        0xE5,
        0x0A,
        0x25,
        0x50,
        0x41,
        0x44,
        0x4F,
        0x6E,
        0xE8,
        0xF8,
        0x0F,
        0x39,
        0x21,
        0x9E,
        0xD4,
        0xED,
        0x05,
        0x14,
        0x4F,
        0x6F,
        0xF2,
        0x35,
        0xA0,
        0x3F,
        0xFD,
        0x38,
        0x6A,
        0x54,
        0x64,
        0xDF,
        0x18,
        0x0B,
        0x46,
        0x57,
        0xDD,
        0xE7,
        0x5F,
        0x0F,
        0x4F,
        0xD7,
        0xF8,
        0x04,
        0x3D,
        0x02,
        0x53,
        0x13,
        0x18,
        0x00,
        0x1A,
        0xE5,
        0xB8,
        0x13,
        0x63,
        0x07,
        0x7F,
        0x3E,
        0xE0,
        0xEC,
        0xEA,
        0xE2,
        0xF8,
        0xFF,
        0x1E,
        0xA7,
        0xA5,
        0x07,
        0xEA,
        0x96,
        0x0B,
        0xC5,
        0x9C,
        0xD2,
        0x2D,
        0xE5,
        0x0C,
        0xFA,
        0x92,
        0x22,
        0xD8,
        0x9C,
        0xB3,
        0x6E,
        0x3F,
        0xD2,
        0xD6,
        0xC0,
        0x5C,
        0xEF,
        0xB9,
        0x94,
        0x84,
        0x90,
        0x38,
        0x27,
        0x61,
        0xE6,
        0x89,
        0x17,
        0xB8,
        0x2B,
        0x00,
        0xDE,
        0xAE,
        0x04,
        0xFA,
        0x59,
        0xDF,
        0x43,
        0xE1,
        0xC5,
        0x6F,
        0x41,
        0xF5,
        0xF9,
        0xA5,
        0x1E,
        0x55,
        0x37,
        0xDF,
        0x3E,
        0xC3,
        0x26,
        0x01,
        0x00,
        0x2F,
        0x7F,
        0x88,
        0xE8,
        0x0F,
        0x4E,
        0x1A,
        0x77,
        0x3E,
        0x8C,
        0x26,
        0x25,
        0x95,
        0x0D,
        0x0B,
        0x4F,
        0xB7,
        0xAC,
        0x08,
        0x2E,
        0x67,
        0xD9,
        0xC6,
        0xCC,
        0x71,
        0x22,
        0xB7,
        0x9E,
        0x42,
        0x46,
        0xE4,
        0x7E,
        0xB4,
        0x65,
        0xE3,
        0x03,
        0x88,
        0x17,
        0x54,
        0xFA,
        0xF7,
        0x0A,
        0x27,
        0x83,
        0xA1,
        0xA4,
        0x9C,
        0xA7,
        0x7B,
        0x81,
        0xCA,
        0x79,
        0x95,
        0xFE,
        0x38,
        0xB7,
        0x5A,
        0xBB,
        0x61,
        0x34,
        0xB1,
        0x1A,
        0x78,
        0x0D,
        0xD7,
        0xDD,
        0xC8,
        0x3F,
        0x9B,
        0x98,
        0x43,
        0xD0,
        0xFC,
        0xC4,
        0x4B,
        0xEA,
        0xEC,
        0xE5,
        0x79,
        0x91,
        0x92,
        0x51,
        0x68,
        0x55,
        0xE4,
        0x67,
        0xB2,
        0x63,
        0x2D,
        0x1E,
        0x52,
        0x4B,
        0x41,
        0x23,
        0x09,
        0x0F,
        0x0D,
        0xC7,
        0x73,
        0xE9,
        0x95,
        0xED,
        0xE8,
        0x3A,
        0x90,
        0x35,
        0x95,
        0x12,
        0xF0,
        0x89,
        0xB3,
        0xD5,
        0x2E,
        0x46,
        0x19,
        0x86,
        0xEE,
        0xC9,
        0xBC,
        0x52,
        0x76,
        0x0B,
        0x11,
        0xEC,
        0x9C,
        0xDA,
        0x8D,
        0x63,
        0x4C,
        0x43,
        0x5B,
        0x64,
        0x32,
        0x1E,
        0x7B,
        0x64,
        0x3B,
        0xBD,
        0x35,
        0x53,
        0x05,
        0xE9,
        0x36,
        0x67,
        0xA7,
        0x15,
        0x2C,
        0x84,
        0x60,
        0x30,
        0xC6,
        0xF1,
        0x62,
        0x9E,
        0x3D,
        0xCE,
        0x98,
        0x93,
        0xA2,
        0xE5,
        0xAC,
        0xC0,
        0xC2,
        0x45,
        0x2D,
        0x25,
        0x38,
        0xEB,
        0x7E,
        0xCF,
        0x0D,
        0xAB,
        0xB2,
        0xBF,
        0x8A,
        0x40,
        0xFC,
        0x14,
        0x56,
        0xF3,
        0xB8,
        0x87,
        0x6F,
        0x81,
        0x37,
        0x18,
        0xF4,
        0xBB,
        0x2E,
        0x4A,
        0x98,
        0xC0,
        0x4A,
        0x5F,
        0x83,
        0xA4,
        0x24,
        0xD7,
        0xB3,
        0xE5,
        0x4E,
        0x65,
        0xA3,
        0x0E,
        0x59,
        0x24,
        0xD5,
        0x91,
        0x32,
        0xEC,
        0x00,
        0x24,
        0x9A,
        0x87,
        0x6F,
        0xFA,
        0x5C,
        0xF5,
        0x46,
        0x4C,
        0x5A,
        0x01,
        0xB5,
        0x8B,
        0xE7,
        0x0B,
        0xB9,
        0xB0,
        0x64,
        0x96,
        0x99,
        0xB8,
        0xB3,
        0x5F,
        0x4F,
        0xF0,
        0x7E,
        0x6B,
        0x34,
        0x07,
        0x82,
        0x04,
        0xF1,
        0x8C,
        0xBA,
        0x02,
        0x5A,
        0x10,
    };
    unsigned char a_pub_key[] = {
        0xCD,
        0x21,
        0x1D,
        0x0B,
        0x87,
        0x31,
        0x93,
        0xF5,
        0xE8,
        0x20,
        0xBA,
        0xF9,
        0x92,
        0xF7,
        0x34,
        0xF7,
        0x95,
        0x08,
        0x4D,
        0xF3,
        0xE4,
        0x51,
        0x0E,
        0xDA,
        0xDC,
        0xB6,
        0x7C,
        0x5C,
        0xD0,
        0x3E,
        0x35,
        0xBB,
        0xD3,
        0x6A,
        0xD9,
        0xEA,
        0x9E,
        0x04,
        0xA9,
        0xCA,
        0xAB,
        0x1D,
        0x85,
        0x7A,
        0x18,
        0xC5,
        0x96,
        0x78,
        0xB0,
        0x5F,
        0x6D,
        0xEF,
        0x11,
        0x81,
        0xB5,
        0x51,
        0x06,
        0xEB,
        0x14,
        0x85,
        0xE5,
        0x8C,
        0x29,
        0x15,
        0xC4,
        0xD0,
        0xD8,
        0x31,
        0xDB,
        0x27,
        0x68,
        0x5C,
        0x45,
        0x75,
        0x21,
        0x15,
        0x5B,
        0xDF,
        0xC7,
        0xF2,
        0xD5,
        0x3F,
        0xFB,
        0x03,
        0xC2,
        0x55,
        0x78,
        0xC9,
        0x3B,
        0x58,
        0x5F,
        0xF0,
        0x89,
        0x72,
        0x7E,
        0xF1,
        0xA6,
        0xB2,
        0x24,
        0x65,
        0xBA,
        0x04,
        0xFE,
        0xF5,
        0x73,
        0x08,
        0xC4,
        0xD8,
        0x51,
        0x7B,
        0xA2,
        0xB8,
        0xAE,
        0x5D,
        0x6F,
        0x1E,
        0x1B,
        0x08,
        0xB7,
        0xD6,
        0xE3,
        0x5B,
        0x8C,
        0x95,
        0xC2,
        0x53,
        0x2E,
        0xE0,
        0xFE,
        0xE1,
        0x86,
        0xA4,
        0x5B,
        0x0A,
        0x9D,
        0x6A,
        0x67,
        0xE6,
        0x28,
        0xE2,
        0xEC,
        0x3D,
        0x0B,
        0x0C,
        0xEB,
        0x8D,
        0x03,
        0xAF,
        0x79,
        0x2F,
        0xB5,
        0x43,
        0x18,
        0x9B,
        0xF4,
        0x08,
        0xDB,
        0xF7,
        0x2D,
        0xBE,
        0xDC,
        0x80,
        0xD4,
        0xB3,
        0x06,
        0xCA,
        0x91,
        0x8B,
        0x04,
        0x9D,
        0x10,
        0xF8,
        0xB5,
        0x2A,
        0x6B,
        0x15,
        0xAE,
        0x41,
        0x7C,
        0x06,
        0xA1,
        0xD9,
        0xBE,
        0xBB,
        0x74,
        0xD6,
        0x07,
        0xD6,
        0xC8,
        0xA2,
        0x4F,
        0x35,
        0x42,
        0x51,
        0xA8,
        0xD6,
        0x73,
        0x83,
        0x3F,
        0xE3,
        0x68,
        0xF5,
        0x50,
        0xB2,
        0x9B,
        0x79,
        0xB3,
        0xD1,
        0xD8,
        0xCC,
        0x3D,
        0xB6,
        0x62,
        0x50,
        0x1A,
        0x9A,
        0xCE,
        0x0D,
        0xF4,
        0xAF,
        0x1B,
        0x4D,
        0x2D,
        0x50,
        0xAA,
        0x39,
        0x62,
        0x1A,
        0x57,
        0x4D,
        0x09,
        0xD7,
        0x62,
        0x69,
        0x4F,
        0x78,
        0x87,
        0x14,
        0xE5,
        0x32,
        0x65,
        0x49,
        0xC9,
        0x55,
        0x15,
        0x42,
        0x4E,
        0xF2,
        0xF3,
        0xED,
        0x63,
        0xF3,
        0x71,
        0x02,
        0x40,
        0x16,
        0x10,
        0x36,
        0x8E,
        0x87,
        0xE3,
        0x6C,
        0x29,
        0x74,
        0x5B,
        0x4F,
        0x92,
        0x77,
        0x84,
        0x0B,
        0xA4,
        0x21,
        0x32,
        0xC5,
        0x19,
        0x00,
        0x4C,
        0x07,
        0x0B,
        0xC3,
        0x9F,
        0x3D,
        0x62,
        0xAA,
        0xA8,
        0x60,
        0xFF,
        0x05,
        0x0F,
        0x86,
        0x69,
        0x8A,
        0x13,
        0xFB,
        0x9E,
        0xC7,
        0x07,
        0xD4,
        0x4C,
        0xA6,
        0xE5,
        0xFB,
        0xE4,
        0xB9,
        0x97,
        0x23,
        0x8F,
        0xF6,
        0x65,
        0x06,
        0x17,
        0x31,
        0x81,
        0xAF,
        0xD6,
        0x1D,
        0x94,
        0xAD,
        0x8E,
        0x1C,
        0x2A,
        0x59,
        0x35,
        0x13,
        0xE9,
        0x94,
        0x50,
        0x84,
        0x5E,
        0xB5,
        0x3B,
        0xE6,
        0x62,
        0x5E,
        0x66,
        0x53,
        0xEE,
        0x04,
        0xE8,
        0xEF,
        0x34,
        0x0A,
        0x27,
        0x8F,
        0xE9,
        0xD9,
        0x02,
        0xE5,
        0x2A,
        0xA7,
        0x9B,
        0x24,
        0xAC,
        0xEF,
        0x42,
        0xD2,
        0x53,
        0x13,
        0x04,
        0x86,
        0xB3,
        0xBF,
        0x15,
        0xE3,
        0xA0,
        0x60,
        0xE1,
        0x34,
        0xEE,
        0xB9,
        0xAA,
        0xE6,
        0xCB,
        0xC7,
        0x33,
        0x3B,
        0xE8,
        0x07,
        0xF1,
        0xCA,
        0xA0,
        0x22,
        0x06,
        0xC1,
        0xC6,
        0xCC,
        0x60,
        0xAD,
        0xE8,
        0xEA,
        0x0B,
        0x96,
        0x8B,
        0xC0,
        0x25,
        0x84,
        0x42,
        0x15,
        0x60,
        0x35,
        0x78,
        0xDD,
        0xB1,
        0xA0,
        0x20,
        0x72,
        0x98,
        0xA3,
        0xF6,
        0x68,
        0x52,
        0xBC,
        0x0B,
        0x6A,
        0xFB,
        0x46,
        0xBA,
        0x9D,
        0xE2,
        0x5B,
        0x48,
        0x5D,
        0x8D,
        0x4A,
        0x12,
        0x82,
        0x4F,
        0xC9,
        0xFD,
        0xE1,
        0x08,
        0x90,
        0xE2,
        0xB3,
        0xDE,
        0xF3,
        0x57,
        0x32,
        0x9C,
        0x1C,
        0xFB,
        0x39,
        0xDE,
        0xD8,
        0x19,
        0xCC,
        0x1A,
        0xA8,
        0xAD,
        0xDD,
        0x2B,
        0xBE,
        0x4C,
        0xD8,
        0x82,
        0x9C,
        0x61,
        0x2C,
        0x20,
        0xD2,
        0xAF,
        0xEF,
        0x17,
        0x64,
        0x88,
        0x05,
        0x3B,
        0x51,
        0x4D,
        0xE8,
        0x25,
        0xAA,
        0xAB,
        0x3D,
        0x05,
        0xA9,
        0x03,
        0xDB,
        0x30,
        0xF8,
        0x2B,
        0x30,
        0x16,
        0xD2,
        0x36,
        0x54,
        0x6F,
        0x8A,
        0xF9,
        0x79,
        0x8B,
        0x72,
        0xAC,
        0xC2,
        0x97,
        0xAA,
        0x5D,
        0x8D,
        0x6A,
        0xDF,
        0x65,
        0x28,
        0x4C,
        0x7E,
        0x14,
        0x63,
        0x57,
        0xD1,
        0x3C,
        0x90,
        0xA8,
        0x82,
    };
    unsigned char b_pri_key[] = {
        0x73,
        0xEA,
        0x00,
        0xE0,
        0xC8,
        0x24,
        0x1A,
        0xBA,
        0xBC,
        0x75,
        0x95,
        0xEF,
        0x95,
        0xB1,
        0xC3,
        0xFD,
        0xEF,
        0xAD,
        0xCD,
        0x11,
        0xDD,
        0x75,
        0x06,
        0xCF,
        0xD7,
        0xCA,
        0x3E,
        0xB8,
        0x83,
        0x0F,
        0xBE,
        0xDE,
        0xD0,
        0x0B,
        0x97,
        0x6B,
        0x59,
        0x6B,
        0xF5,
        0xFC,
        0x28,
        0x7F,
        0x59,
        0x51,
        0x61,
        0x78,
        0x90,
        0x79,
        0xC5,
        0xCD,
        0x36,
        0x71,
        0x1E,
        0xB3,
        0x59,
        0xB5,
        0x75,
        0x9E,
        0x58,
        0x02,
        0xC5,
        0x99,
        0x49,
        0x3B,
        0xFC,
        0x6E,
        0xD5,
        0x14,
        0x78,
        0x1F,
        0x9A,
        0xE5,
        0xD6,
        0xC0,
        0xC1,
        0x51,
        0x19,
        0xA7,
        0x6F,
        0x31,
        0x11,
        0x36,
        0x0F,
        0xDF,
        0x77,
        0x89,
        0x09,
        0x6D,
        0x6D,
        0x32,
        0x9D,
        0xAF,
        0xE4,
        0xC4,
        0xEC,
        0xF7,
        0x9A,
        0x47,
        0x61,
        0x1D,
        0x9F,
        0x44,
        0xE2,
        0x2E,
        0x41,
        0x5A,
        0xCA,
        0x2D,
        0xF4,
        0x0F,
        0xB5,
        0xDE,
        0xEE,
        0xAA,
        0x99,
        0x35,
        0xEB,
        0xD6,
        0x88,
        0x47,
        0xDC,
        0xD2,
        0x0D,
        0xED,
        0xAD,
        0xB4,
        0x21,
        0x93,
        0x06,
        0x31,
        0x0A,
        0x22,
        0x15,
        0xFD,
        0x14,
        0x4F,
        0x60,
        0xEC,
        0x9E,
        0x51,
        0x76,
        0xDD,
        0x02,
        0xE6,
        0x45,
        0x35,
        0x3D,
        0xF3,
        0x4D,
        0x1F,
        0x37,
        0x86,
        0xCF,
        0x43,
        0xFB,
        0x41,
        0xB3,
        0x27,
        0x7C,
        0xE2,
        0x25,
        0x13,
        0xCA,
        0x11,
        0xA1,
        0x9E,
        0xA2,
        0x6F,
        0x00,
        0x78,
        0x2B,
        0xDD,
        0x09,
        0x19,
        0xE1,
        0x83,
        0xB4,
        0x61,
        0xB6,
        0x14,
        0x83,
        0x66,
        0xA2,
        0xFE,
        0x91,
        0x34,
        0x48,
        0x44,
        0x9B,
        0x0C,
        0x20,
        0xDF,
        0x93,
        0x24,
        0x54,
        0x1B,
        0x77,
        0x73,
        0xD4,
        0x06,
        0xFB,
        0xF0,
        0x9E,
        0xA6,
        0xA6,
        0x42,
        0xD0,
        0x86,
        0xEA,
        0x70,
        0x35,
        0x37,
        0x63,
        0xC4,
        0x5F,
        0x7B,
        0xC3,
        0x37,
        0xCC,
        0xED,
        0x80,
        0xC3,
        0xA5,
        0x60,
        0x0A,
        0xD2,
        0x7D,
        0xD3,
        0x2E,
        0xAB,
        0xF2,
        0x83,
        0xF6,
        0x09,
        0xF2,
        0x87,
        0xC6,
        0x79,
        0x45,
        0x2D,
        0xFC,
        0xBE,
        0x12,
        0x4B,
        0xBD,
        0x00,
        0x06,
        0x79,
        0x6A,
        0xF1,
        0x39,
        0x50,
        0xDC,
        0x7A,
        0x25,
        0xF4,
        0x47,
        0xEB,
        0x7E,
        0xC6,
        0xD0,
        0x55,
        0x77,
        0x34,
        0x73,
        0x90,
        0xC7,
        0xC4,
        0xB8,
        0xEF,
        0xA0,
        0xF6,
        0x67,
        0x86,
        0x72,
        0xFB,
        0xA1,
        0xE6,
        0xD4,
        0xE1,
        0x43,
        0xCF,
        0xAF,
        0x36,
        0x68,
        0x05,
        0xB8,
        0x4F,
        0xB0,
        0xED,
        0xC3,
        0xFD,
        0xA0,
        0xFA,
        0x9A,
        0x0F,
        0x91,
        0xB1,
        0x20,
        0x5D,
        0xE4,
        0xC1,
        0x57,
        0xDE,
        0x36,
        0x2B,
        0x8E,
        0x07,
        0xB5,
        0x86,
        0x0F,
        0x7B,
        0x92,
        0xF8,
        0xF6,
        0xD0,
        0x8D,
        0x15,
        0x5B,
        0x75,
        0x6D,
        0x9C,
        0x63,
        0xF3,
        0xDE,
        0x6F,
        0x56,
        0x1F,
        0x7B,
        0xAC,
        0x90,
        0x3B,
        0x76,
        0x48,
        0x22,
        0x12,
        0x8E,
        0x78,
        0x98,
        0x2E,
        0xD9,
        0x9A,
        0xB8,
        0x65,
        0x87,
        0x72,
        0x0F,
        0xCE,
        0x24,
        0x37,
        0xE1,
        0x4A,
        0x68,
        0x92,
        0x24,
        0x23,
        0xA9,
        0xE2,
        0xB1,
        0xCC,
        0xF7,
        0x41,
        0x6F,
        0x11,
        0xC1,
        0x22,
        0xCD,
        0xB9,
        0x2B,
        0xAA,
        0x6D,
        0x57,
        0xC9,
        0xA8,
        0xE3,
        0xC1,
        0x45,
        0x0B,
        0x42,
        0xD3,
        0xCE,
        0x10,
        0x7C,
        0xA6,
        0xDE,
        0xBA,
        0x65,
        0x77,
        0xDA,
        0xC0,
        0xEF,
        0xEB,
        0xAC,
        0xF5,
        0x84,
        0x78,
        0x55,
        0x32,
        0x71,
        0x5A,
        0x45,
        0x78,
        0x91,
        0x6A,
        0x8C,
        0x3C,
        0x5B,
        0x69,
        0x2F,
        0x12,
        0x22,
        0xCF,
        0xEA,
        0x48,
        0x4D,
        0x30,
        0x8C,
        0x62,
        0x45,
        0x6F,
        0xEB,
        0x2C,
        0xD1,
        0xB1,
        0xCE,
        0x6A,
        0x6F,
        0x0B,
        0x01,
        0xE7,
        0x77,
        0x06,
        0xCA,
        0xF6,
        0xE9,
        0xCA,
        0x39,
        0x44,
        0x14,
        0xCD,
        0x49,
        0x7D,
        0xC9,
        0x48,
        0xCE,
        0xA0,
        0x45,
        0x94,
        0x73,
        0x5F,
        0x5A,
        0xCA,
        0x4E,
        0x8E,
        0x64,
        0xBE,
        0x33,
        0x42,
        0x4B,
        0x11,
        0xF7,
        0xD9,
        0xF6,
        0xC9,
        0x11,
        0x92,
        0xAD,
        0xCD,
        0x79,
        0x79,
        0x7F,
        0x34,
        0x22,
        0x86,
        0xEA,
        0xDE,
        0xA5,
        0x08,
        0xAC,
        0x17,
        0xC5,
        0x08,
        0x97,
        0x51,
        0x87,
        0x56,
        0xAC,
        0x7D,
        0xDF,
        0xD1,
        0xAA,
        0xB3,
        0xAC,
        0x64,
        0x59,
        0x80,
        0x03,
        0x47,
        0x4D,
        0x27,
        0x41,
        0x32,
        0xD8,
        0x14,
        0x16,
        0xD4,
        0x88,
        0xFF,
        0x92,
        0xE4,
        0x46,
        0x75,
    };
    unsigned char b_pub_key[] = {
        0xDA,
        0x55,
        0x13,
        0x17,
        0x58,
        0x54,
        0xA0,
        0x1A,
        0x8F,
        0xA8,
        0xCC,
        0x77,
        0x2B,
        0xB1,
        0x20,
        0x6C,
        0x6C,
        0x49,
        0x98,
        0x19,
        0xC8,
        0x19,
        0xDC,
        0xEF,
        0x06,
        0x7E,
        0xF7,
        0x4D,
        0x0A,
        0x16,
        0xC2,
        0x62,
        0x67,
        0xF9,
        0xAB,
        0x17,
        0x28,
        0xEC,
        0xE1,
        0x18,
        0x65,
        0xA6,
        0x5D,
        0x4D,
        0x15,
        0xA2,
        0x38,
        0xBB,
        0x26,
        0xD6,
        0x5F,
        0x89,
        0x5B,
        0xD4,
        0x94,
        0x5C,
        0xB9,
        0x0F,
        0x3F,
        0x71,
        0x9A,
        0x37,
        0xFB,
        0x5D,
        0x91,
        0x71,
        0xAC,
        0xD0,
        0x5A,
        0x00,
        0xAA,
        0x26,
        0x3F,
        0x9D,
        0x19,
        0xED,
        0xF9,
        0xDC,
        0x73,
        0x6B,
        0x17,
        0x8F,
        0xAD,
        0xFE,
        0x66,
        0xAD,
        0x2E,
        0xCF,
        0x88,
        0x3A,
        0xA5,
        0xE7,
        0xBB,
        0xCE,
        0x0D,
        0xC6,
        0x8C,
        0x20,
        0x78,
        0x80,
        0x6D,
        0x33,
        0x5C,
        0x50,
        0xE4,
        0xD6,
        0xD5,
        0x32,
        0x45,
        0xCD,
        0xAB,
        0xF0,
        0x8E,
        0x22,
        0x89,
        0x97,
        0xB4,
        0xAE,
        0x47,
        0xA3,
        0xF9,
        0x79,
        0x5E,
        0xAB,
        0xFA,
        0x98,
        0x0C,
        0x3C,
        0xAA,
        0x66,
        0x5B,
        0xCD,
        0x35,
        0x69,
        0x38,
        0xEC,
        0x50,
        0xBF,
        0xEC,
        0x28,
        0x52,
        0x23,
        0xF1,
        0x2C,
        0x54,
        0xA2,
        0x23,
        0xF4,
        0x06,
        0x5C,
        0x95,
        0x4B,
        0xD7,
        0x41,
        0xE0,
        0xD8,
        0x17,
        0x64,
        0x2C,
        0xEB,
        0x10,
        0xB0,
        0x4E,
        0x27,
        0xBD,
        0x49,
        0x60,
        0xCA,
        0x8D,
        0x79,
        0xE1,
        0x4E,
        0x7A,
        0x08,
        0xD7,
        0x30,
        0xA6,
        0xC0,
        0x71,
        0x1F,
        0x73,
        0xD6,
        0x6C,
        0x83,
        0xE3,
        0xD6,
        0xD4,
        0x52,
        0x43,
        0xE1,
        0x53,
        0x74,
        0x94,
        0x1B,
        0xA5,
        0x20,
        0xFA,
        0xF2,
        0x94,
        0x42,
        0x72,
        0x6F,
        0xE8,
        0x30,
        0xBE,
        0x49,
        0x3E,
        0xE4,
        0x70,
        0xC5,
        0x51,
        0x8A,
        0x4F,
        0x83,
        0x5C,
        0xD2,
        0x36,
        0x98,
        0xB8,
        0xBD,
        0xF7,
        0xA1,
        0x9F,
        0x3C,
        0x2D,
        0xBB,
        0x2E,
        0x52,
        0xC8,
        0xDA,
        0x2F,
        0x2F,
        0x4D,
        0x0C,
        0x66,
        0x9C,
        0x52,
        0xB1,
        0x41,
        0xB5,
        0x35,
        0xB1,
        0xB2,
        0x62,
        0x93,
        0x04,
        0xD9,
        0x93,
        0x8B,
        0x5F,
        0x57,
        0x7E,
        0x40,
        0x01,
        0xD6,
        0x44,
        0x77,
        0x1F,
        0xAC,
        0xEE,
        0x95,
        0x97,
        0xD9,
        0xBB,
        0x9B,
        0xFB,
        0xC5,
        0x49,
        0x29,
        0x0E,
        0x98,
        0xD9,
        0x3B,
        0x1B,
        0xD0,
        0x9A,
        0x16,
        0x90,
        0xFB,
        0xFE,
        0x56,
        0xFC,
        0x95,
        0x8D,
        0xC0,
        0x85,
        0xDF,
        0x18,
        0xAE,
        0xC8,
        0x7F,
        0x39,
        0x4F,
        0x6A,
        0x88,
        0x6B,
        0xB4,
        0x2C,
        0x6A,
        0xA8,
        0xA1,
        0x7F,
        0x24,
        0xD4,
        0x5E,
        0xEE,
        0x56,
        0x05,
        0x01,
        0xA5,
        0x8C,
        0x24,
        0x4C,
        0xE7,
        0x81,
        0xE5,
        0xD8,
        0x57,
        0xDF,
        0x8E,
        0xC8,
        0x04,
        0x76,
        0x1B,
        0x7C,
        0x21,
        0x92,
        0x8E,
        0xB0,
        0xA0,
        0x2B,
        0x04,
        0xD9,
        0x38,
        0xAD,
        0x95,
        0xC2,
        0x4F,
        0x1B,
        0xCE,
        0xFD,
        0x08,
        0xE4,
        0xF9,
        0x47,
        0x6F,
        0x96,
        0xEB,
        0x84,
        0xD9,
        0x9E,
        0x6E,
        0xAA,
        0xE8,
        0xC9,
        0xBC,
        0x7E,
        0xFE,
        0x39,
        0x2B,
        0xAF,
        0x0F,
        0x80,
        0xBD,
        0xF7,
        0x44,
        0x41,
        0x39,
        0x0D,
        0x5A,
        0xA2,
        0x34,
        0x8F,
        0xB0,
        0xB7,
        0xAC,
        0x0B,
        0x4A,
        0x19,
        0x3E,
        0xF7,
        0x76,
        0x37,
        0x5D,
        0x8A,
        0xFB,
        0x48,
        0xD5,
        0xE9,
        0xB4,
        0x8D,
        0x01,
        0x64,
        0xED,
        0x41,
        0x99,
        0xFA,
        0xA6,
        0xED,
        0xCC,
        0xF5,
        0x7B,
        0x1E,
        0xC4,
        0x36,
        0x3D,
        0x8E,
        0x7D,
        0x92,
        0x37,
        0xCE,
        0x1D,
        0x97,
        0xE5,
        0x41,
        0x77,
        0x65,
        0xCB,
        0x82,
        0xBB,
        0xA0,
        0x02,
        0xA9,
        0x71,
        0x84,
        0xDA,
        0x54,
        0x0C,
        0x17,
        0x7F,
        0x67,
        0xC9,
        0xB6,
        0xF6,
        0x51,
        0x24,
        0x7F,
        0xCF,
        0xFC,
        0x34,
        0x1D,
        0x50,
        0x13,
        0x7F,
        0x4C,
        0x9E,
        0x30,
        0x2D,
        0xA7,
        0xE0,
        0x69,
        0x57,
        0xF3,
        0xF0,
        0x78,
        0x37,
        0x31,
        0xF3,
        0x52,
        0xD7,
        0xBF,
        0x58,
        0xC3,
        0xC8,
        0xF1,
        0xAF,
        0xCB,
        0x03,
        0xE5,
        0x99,
        0x44,
        0x9D,
        0xDE,
        0xFB,
        0xC8,
        0xA9,
        0x5E,
        0xBF,
        0x1F,
        0x43,
        0x71,
        0x90,
        0x41,
        0x03,
        0xC3,
        0xE4,
        0x2E,
        0xA9,
        0xF4,
        0x10,
        0x05,
        0x5C,
        0x70,
        0x64,
        0x8F,
        0x9B,
        0x89,
        0x06,
        0xB3,
        0x97,
        0xAC,
        0xB7,
        0x9F,
        0x2D,
        0x64,
        0x48,
        0x1F,
        0x9A,
        0x88,
        0xBF,
        0x7C,
        0x67,
    };
    unsigned char std_key[] = {
        0x93,
        0x4F,
        0xC7,
        0xB0,
        0x89,
        0x37,
        0x4B,
        0x4B,
        0x02,
        0x31,
        0xEE,
        0x4D,
        0x96,
        0xE7,
        0x4E,
        0x8F,
        0x8E,
        0x25,
        0xB6,
        0xEA,
        0x72,
        0x51,
        0x3C,
        0x5A,
        0x5D,
        0x2B,
        0xA8,
        0xFF,
        0x80,
        0x3D,
        0x00,
        0x0F,
        0x92,
        0xEF,
        0x2F,
        0xF9,
        0xCD,
        0x7C,
        0xE7,
        0x13,
        0x72,
        0xE7,
        0xA8,
        0xB4,
        0x8F,
        0xD2,
        0x23,
        0x47,
        0xCE,
        0x30,
        0x23,
        0x68,
        0x2C,
        0x2B,
        0x46,
        0x83,
        0x3B,
        0x48,
        0xC7,
        0xD9,
        0x75,
        0x98,
        0xF7,
        0xE3,
        0xE6,
        0x3C,
        0xA1,
        0xFB,
        0x51,
        0xEA,
        0x09,
        0x00,
        0x06,
        0x8B,
        0x3E,
        0xDC,
        0x05,
        0x8A,
        0x01,
        0x1F,
        0x21,
        0x12,
        0x5F,
        0x6A,
        0xCB,
        0x7C,
        0xD1,
        0x5A,
        0x4E,
        0x8E,
        0x97,
        0x92,
        0x71,
        0x6D,
        0x0C,
        0x58,
        0x4E,
        0xF5,
        0x67,
        0x30,
        0x75,
        0x6D,
        0x7F,
        0xBF,
        0x7D,
        0x33,
        0x83,
        0xC7,
        0x2F,
        0xA5,
        0x9B,
        0xB1,
        0x5A,
        0xF8,
        0xC9,
        0x37,
        0x2F,
        0x82,
        0x1F,
        0x59,
        0x60,
        0x85,
        0xB7,
        0xEE,
        0xAD,
        0xDD,
        0x74,
        0x3D,
        0x17,
        0xBA,
        0xB4,
        0xD0,
        0x72,
        0xE8,
        0x52,
        0x68,
        0x7F,
        0x7E,
        0xD9,
        0xA2,
        0x21,
        0xED,
        0x8E,
        0xD0,
        0xFC,
        0x48,
        0xF2,
        0x36,
        0x9A,
        0x11,
        0x4B,
        0x9E,
        0x02,
        0xD5,
        0x0B,
        0x94,
        0x09,
        0x4E,
        0x79,
        0xE7,
        0x8A,
        0x21,
        0xEC,
        0x79,
        0x4B,
        0x8C,
        0x99,
        0xE4,
        0x9B,
        0x69,
        0x24,
        0xCA,
        0x26,
        0x7E,
        0xAE,
        0x6A,
        0x89,
        0xF7,
        0x4B,
        0xFD,
        0x07,
        0x36,
        0x46,
        0xA5,
        0x75,
        0xC6,
        0x23,
        0x9C,
        0x0C,
        0x75,
        0xAF,
        0x17,
        0xEE,
        0x01,
        0x73,
        0xD0,
        0x6D,
        0x3C,
        0xA3,
        0x60,
        0x9D,
        0x80,
        0x20,
        0xB9,
        0xF8,
        0x0E,
        0x39,
        0x74,
        0x67,
        0x30,
        0x6F,
        0x97,
        0xC6,
        0xE5,
        0xF1,
        0x2D,
        0x6F,
        0xB1,
        0xE0,
        0xD9,
        0xD2,
        0xBD,
        0xA5,
        0x39,
        0x14,
        0x48,
        0x1C,
        0xE0,
        0x9E,
        0x1A,
        0x10,
        0x53,
        0xB3,
        0x3F,
        0xBA,
        0x07,
        0x11,
        0x47,
        0x78,
        0x22,
        0x96,
        0x2D,
        0xF2,
        0x68,
        0xCF,
        0x29,
        0x62,
        0xD0,
        0x6D,
        0x88,
        0x1C,
        0xCE,
        0xBF,
        0x10,
        0x1F,
        0x67,
        0xA8,
        0x49,
        0xDD,
        0x9B,
        0xCD,
        0x0B,
        0xD3,
        0xCF,
        0xCE,
        0xD2,
        0xB3,
        0x3C,
        0x62,
        0x62,
        0x94,
        0x14,
        0x2C,
        0xD5,
        0x2D,
        0xBA,
        0x16,
        0xEF,
        0x3D,
        0x13,
        0x98,
        0xF3,
        0x30,
        0x09,
        0xDE,
        0x59,
        0xDA,
        0x28,
        0x49,
        0xF3,
        0x95,
        0x77,
        0x8E,
        0x7B,
        0x5A,
        0xCF,
        0x73,
        0x54,
        0xB5,
        0xC0,
        0x07,
        0xEF,
        0xB5,
        0x85,
        0xF6,
        0xE0,
        0x67,
        0xF1,
        0x16,
        0x06,
        0x13,
        0x0E,
        0x52,
        0x3D,
        0xCF,
        0x2E,
        0x61,
        0x18,
        0x0C,
        0x10,
        0xAE,
        0xCA,
        0xFE,
        0xFF,
        0x2E,
        0x63,
        0x04,
        0x9B,
        0x8E,
        0xF7,
        0x83,
        0x1A,
        0x94,
        0xD2,
        0x12,
        0xC4,
        0x82,
        0x51,
        0x35,
        0x34,
        0x12,
        0xD6,
        0x51,
        0x6C,
        0xD3,
        0xAA,
        0x74,
        0xC1,
        0xD1,
        0xF6,
        0x98,
        0x2E,
        0x95,
        0xE5,
        0x4B,
        0xB7,
        0x49,
        0xDA,
        0x26,
        0x1F,
        0x4C,
        0x25,
        0x10,
        0x19,
        0x84,
        0x79,
        0x73,
        0xD5,
        0xE1,
        0x48,
        0xA3,
        0x98,
        0x95,
        0x9C,
        0x3F,
        0x81,
        0x9C,
        0xEB,
        0x8C,
        0x16,
        0xDE,
        0x48,
        0x88,
        0xE2,
        0x96,
        0xF0,
        0xC3,
        0x2B,
        0x54,
        0xBF,
        0x5B,
        0x75,
        0x69,
        0x90,
        0x31,
        0xF8,
        0xC6,
        0xE3,
        0xD5,
        0x20,
        0x8F,
        0x17,
        0x71,
        0xD4,
        0x88,
        0x0D,
        0xA7,
        0x43,
        0x74,
        0x41,
        0x84,
        0x9E,
        0x88,
        0x4B,
        0xC7,
        0x02,
        0x0E,
        0x61,
        0xC0,
        0x6D,
        0x98,
        0x92,
        0x76,
        0x3A,
        0xEA,
        0x48,
        0xF6,
        0xBE,
        0x3D,
        0x09,
        0xFD,
        0xBC,
        0x92,
        0xDB,
        0x2A,
        0x01,
        0x6B,
        0xB1,
        0x8F,
        0x8D,
        0xE7,
        0xAF,
        0x01,
        0xA9,
        0xB1,
        0x19,
        0xEB,
        0x42,
        0x43,
        0x20,
        0x7D,
        0x90,
        0xBF,
        0xF0,
        0x00,
        0x10,
        0xE5,
        0x28,
        0x1E,
        0xEB,
        0x54,
        0xFA,
        0x1F,
        0x4F,
        0x14,
        0x42,
        0x74,
        0x1C,
        0x00,
        0x4E,
        0x0B,
        0x7E,
        0xE8,
        0xDD,
        0x81,
        0x21,
        0x8F,
        0x88,
        0x84,
        0x72,
        0xB8,
        0xD2,
        0x23,
        0x1F,
        0x2A,
        0x85,
        0xA4,
        0x6F,
        0xB8,
        0x0D,
        0x53,
        0x56,
        0x47,
        0x2B,
        0xF0,
        0xAA,
        0xAA,
        0xF8,
        0xE8,
        0x9B,
        0x46,
        0x03,
        0xFB,
        0x91,
        0xF8,
        0x47,
        0xC9,
        0x25,
        0xE9,
        0xA3,
        0x83,
        0x31,
    };
    unsigned char pubkey[(4096 + 7) / 8];
    unsigned int ret;

    ret = dh_generate_pubkey_from_prikey(dh_para_rfc3526_4096_4095, a_pri_key, pubkey);
    if ((DH_SUCCESS != ret) || memcmp_(pubkey, a_pub_key, (4096 + 7) / 8))
    {
        printf("\r\n generate A public key error, ret = %x", ret);
        fflush(stdout);
        print_buf_u8(pubkey, (4096 + 7) / 8, "A public key");
        return 1;
    }

    ret = dh_generate_pubkey_from_prikey(dh_para_rfc3526_4096_4095, b_pri_key, pubkey);
    if ((DH_SUCCESS != ret) || memcmp_(pubkey, b_pub_key, (4096 + 7) / 8))
    {
        printf("\r\n generate B public key error, ret = %x", ret);
        fflush(stdout);
        print_buf_u8(pubkey, (4096 + 7) / 8, "A public key");
        return 1;
    }

    ret = dh_test_internal(dh_para_rfc3526_4096_4095, a_pri_key, a_pub_key, b_pri_key, b_pub_key, std_key, "dhRFC3526(4096_4095)");
    if (DH_SUCCESS != ret)
    {
        // printf("\r\n dh_test_internal error, ret = %x", ret);fflush(stdout);
        return 1;
    }

    printf("\r\n dhRFC3526(4096_4095) standard data test success");
    fflush(stdout);

    return 0;
}
#endif

/**
 * @brief           Perform random data testing for DH key exchange.
 * @param[in]       dh_para              - Pointer to the DH parameters.
 * @param[in]       para_info            - Additional information for logging purposes.
 * @return          0 if the test is successful, 1 otherwise.
 */
unsigned int dh_rand_test(dh_para_t *dh_para, char *para_info)
{
    unsigned char local_key[DH_MAX_BYTE_LEN], local_prikey[DH_MAX_BYTE_LEN], local_pubkey[DH_MAX_BYTE_LEN];
    unsigned char peer_key[DH_MAX_BYTE_LEN], peer_prikey[DH_MAX_BYTE_LEN], peer_pubkey[DH_MAX_BYTE_LEN];
    unsigned int p_len;
    unsigned int i, j, ret;

    printf("\r\n\r\n ------------- %s DH rand data test ------------- ", para_info);

    p_len = get_byte_len(dh_para->p_bits);

    for (i = 0; i < DH_ROUND1; i++)
    {
        ret = dh_generate_key(dh_para, local_prikey, local_pubkey);
        if (PKE_SUCCESS != ret)
        {
            printf("\r\n DH A get key error, ret=%x", ret);
            return 1;
        }

        ret = dh_generate_key(dh_para, peer_prikey, peer_pubkey);
        if (PKE_SUCCESS != ret)
        {
            printf("\r\n DH B get key error, ret=%x", ret);
            return 1;
        }

        for (j = 0; j < DH_ROUND2; j++)
        {
            printf("\r\n %s DH round1=%u, round2=%u", para_info, i + 1, j + 1);

#ifdef DH_SEC_TEST
            ret = dh_compute_key_s(dh_para, local_prikey, peer_pubkey, local_key);
            if (DH_SUCCESS_S != ret)
#else
            ret = dh_compute_key(dh_para, local_prikey, peer_pubkey, local_key);
            if (DH_SUCCESS != ret)
#endif
            {
                printf("\r\n %s DH test error 1, ret = %02x", para_info, ret);
                return 1;
            }
#ifdef DH_SEC_TEST
            ret = dh_compute_key_s(dh_para, peer_prikey, local_pubkey, peer_key);
            if (DH_SUCCESS_S != ret || memcmp_(local_key, peer_key, p_len))
#else
            ret = dh_compute_key(dh_para, peer_prikey, local_pubkey, peer_key);
            if (DH_SUCCESS != ret || memcmp_(local_key, peer_key, p_len))
#endif
            {
                printf("\r\n %s DH test error 2, ret = %02x", para_info, ret);
                return 1;
            }
        }
    }

    return 0;
}

#if (DH_MAX_BIT_LEN >= 1024)
/**
 * @brief           Perform a random test for DH with 1024-bit prime and 160-bit subprime.
 * @return          The result of the test, SM9_SUCCESS if successful, other values indicate an error.
 */
unsigned int dh_static_1024_160_rand_test(void)
{
    return dh_rand_test((dh_para_t *)dh_para_dh_static_1024_160, "dhStatic(1024-160)");
}
#endif

#if (DH_MAX_BIT_LEN >= 1024)
/**
 * @brief           Perform a random test for ephemeral DH with 1024-bit prime and 160-bit subprime.
 * @return          The result of the test, SM9_SUCCESS if successful, other values indicate an error.
 */
unsigned int dh_ephemeral_1024_160_rand_test(void)
{
    unsigned int p_buf[DH_MAX_WORD_LEN];
    unsigned int q_buf[DH_MAX_WORD_LEN];
    unsigned int g_buf[DH_MAX_WORD_LEN];
    unsigned int ret;

    dh_para_t dh_para[1];

    ret = dh_param_pointer_init(dh_para, p_buf, 1024, NULL, NULL, q_buf, 160, g_buf, 1024);
    if (DH_SUCCESS != ret)
    {
        printf("\r\n dh_param_pointer_init error, ret = %x", ret);
        fflush(stdout);
        return 1;
    }

    ret = dh_param_value_init(dh_para, p_e_1, NULL, NULL, q_e_1, g_e_1);
    if (DH_SUCCESS != ret)
    {
        printf("\r\n dh_param_value_init error, ret = %x", ret);
        fflush(stdout);
        return 1;
    }

    return dh_rand_test(dh_para, "dhEpheme(1024-160)");
}
#endif

#if (DH_MAX_BIT_LEN >= 2048)
/**
 * @brief           Perform a random test for ephemeral DH with 2048-bit prime and 224-bit subprime.
 * @return          The result of the test, SM9_SUCCESS if successful, other values indicate an error.
 */
unsigned int dh_rfc5114_2048_224_rand_test(void)
{
    return dh_rand_test(dh_para_rfc5114_2048_224, "dhRFC5114(2048-224)");
}
#endif

#if (DH_MAX_BIT_LEN >= 3072)
/**
 * @brief           Perform a random test for ephemeral DH with 3072-bit prime and 3071-bit subprime.
 * @return          The result of the test, SM9_SUCCESS if successful, other values indicate an error.
 */
unsigned int dh_rfc3526_3072_3071_rand_test(void)
{
    return dh_rand_test(dh_para_rfc3526_3072_3071, "dhRFC3526(3072-3071)");
}
#endif

#if (DH_MAX_BIT_LEN >= 4096)
/**
 * @brief           Perform a random test for DH with 4096-bit prime and 4095-bit subprime.
 * @return          The result of the test, SM9_SUCCESS if successful, other values indicate an error.
 */
unsigned int dh_rfc3526_4096_4095_rand_test(void)
{
    return dh_rand_test(dh_para_rfc3526_4096_4095, "dhRFC3526(4096_4095)");
}
#endif

/**
 * @brief           Perform speed testing for DH key exchange operations.
 * @param[in]       dh_para              - Pointer to the DH parameters.
 * @param[in]       para_info            - Additional information for logging purposes.
 * @return          0 if the test is successful, 1 otherwise.
 */
unsigned int dh_speed_test(dh_para_t *dh_para, char *para_info)
{
    unsigned char local_prikey[DH_MAX_BYTE_LEN];
    unsigned char local_pubkey[DH_MAX_BYTE_LEN];
    unsigned char peer_prikey[DH_MAX_BYTE_LEN];
    unsigned char peer_pubkey[DH_MAX_BYTE_LEN];
    unsigned char local_key[DH_MAX_BYTE_LEN];
    unsigned char peer_key[DH_MAX_BYTE_LEN];
    unsigned int p_len = get_byte_len(dh_para->p_bits);
    unsigned int i, round;
#ifdef DH_SPEED_TEST_BY_TIMER
    unsigned int divisor;
#endif
    unsigned int ret;

    printf("\r\n\r\n *************************** %s *************************** "
           "\r\n",
           para_info);

    if (dh_para->p_bits <= 1024)
    {
        round = 250;
#ifdef DH_SPEED_TEST_BY_TIMER
        divisor = 20;
#endif
    }
    else if (dh_para->p_bits <= 2048)
    {
        round = 100;
#ifdef DH_SPEED_TEST_BY_TIMER
        divisor = 20;
#endif
    }
    else if (dh_para->p_bits <= 3072)
    {
        round = 1;
#ifdef DH_SPEED_TEST_BY_TIMER
        divisor = 1;
#endif
    }
    else if (dh_para->p_bits <= 4096)
    {
        round = 1;
#ifdef DH_SPEED_TEST_BY_TIMER
        divisor = 1;
#endif
    }

    // test dh_generate_key
    printf("\r\n ======== dh_generate_key begin ======== ");
    fflush(stdout);

#ifdef DH_SPEED_TEST_BY_TIMER
    round /= divisor;
    startp();
#endif

    for (i = 0; i < round; i++)
    {
        ret = dh_generate_key(dh_para, local_prikey, local_pubkey);
        if (PKE_SUCCESS != ret)
        {
            printf("\r\n DH A get key error, ret=%x", ret);
            return 1;
        }
    }

#ifdef DH_SPEED_TEST_BY_TIMER
    endp(1, 0, round);
#else
    printf("\r\n finished");
    fflush(stdout);
#endif

    ret = dh_generate_key(dh_para, peer_prikey, peer_pubkey);
    if (PKE_SUCCESS != ret)
    {
        printf("\r\n DH B get key error, ret=%x", ret);
        return 1;
    }

    // test dh_compute_key
    ret = 0;
    printf("\r\n ======== dh_compute_key begin ======== ");
    fflush(stdout);

#ifdef DH_SPEED_TEST_BY_TIMER
    startp();
#endif

    for (i = 0; i < round; i++)
    {
        ret = dh_compute_key(dh_para, local_prikey, peer_pubkey, local_key);
        if (DH_SUCCESS != ret)
        {
            printf("\r\n dh_compute_key test error, ret = %x", ret);
            return 1;
        }
    }

#ifdef DH_SPEED_TEST_BY_TIMER
    endp(1, 0, round);
#else
    printf("\r\n finished");
    fflush(stdout);
#endif

// test dh_compute_key_s
#ifdef DH_SEC_TEST
    ret = 0;
    printf("\r\n ======== dh_compute_key_s begin ======== ");
    fflush(stdout);

#ifdef DH_SPEED_TEST_BY_TIMER
    startp();
#endif

    for (i = 0; i < round; i++)
    {
        ret = dh_compute_key_s(dh_para, peer_prikey, local_pubkey, peer_key);
        if (DH_SUCCESS_S != ret)
        {
            printf("\r\n dh_compute_key_s test error, ret = %x", ret);
            return 1;
        }
    }

#ifdef DH_SPEED_TEST_BY_TIMER
    endp(1, 0, round);
#else
    printf("\r\n finished");
    fflush(stdout);
#endif

#else
    ret = dh_compute_key(dh_para, peer_prikey, local_pubkey, peer_key);
    if (DH_SUCCESS != ret)
    {
        printf("\r\n dh_compute_key test error, ret = %x", ret);
        return 1;
    }
#endif

    if (memcmp_(local_key, peer_key, p_len))
    {
        printf("\r\n DH test error, ret = %x", ret);
        return 1;
    }

    return 0;
}

/**
 * @brief           Perform all DH tests, including standard data tests and random data tests.
 * @return          0 if all tests are successful, 1 if any test fails.
 */
unsigned int dh_all_test(void)
{
    // unsigned int ret;

    printf("\r\n\r\n =================== DH test =================== ");

#if 0

#if (DH_MAX_BIT_LEN >= 1024)
    if(dh_speed_test((dh_para_t *)dh_para_dh_static_1024_160, "dhStatic(1024-160)"))
        return 1;
#endif

#if (DH_MAX_BIT_LEN >= 2048)
    if(dh_speed_test((dh_para_t *)dh_para_rfc5114_2048_224, "dhRFC5114(2048-224)"))
        return 1;
#endif

#if (DH_MAX_BIT_LEN >= 3072)
    if(dh_speed_test((dh_para_t *)dh_para_rfc3526_3072_3071, "dhRFC3526(3072-3071)"))
        return 1;
#endif

#if (DH_MAX_BIT_LEN >= 4096)
    if(dh_speed_test((dh_para_t *)dh_para_rfc3526_4096_4095, "dhRFC3526(4096_4095)"))
        return 1;
#endif

#else
/**/
// standard data test
#if (DH_MAX_BIT_LEN >= 1024)
    // data ref : ANSI X9.42 2003 Annex D.3.1
    if (dh_static_1024_160_std_test())
    {
        return 1;
    }
#endif

#if (DH_MAX_BIT_LEN >= 1024)
    // data ref : ANSI X9.42 2003 Annex D.3.2
    if (dh_ephemeral_1024_160_std_test())
    {
        return 1;
    }
#endif

#if (DH_MAX_BIT_LEN >= 2048)
    if (dh_rfc5114_2048_224_std_test())
    {
        return 1;
    }
#endif

#if (DH_MAX_BIT_LEN >= 3072)
    if (dh_rfc3526_3072_3071_std_test())
    {
        return 1;
    }
#endif

#if (DH_MAX_BIT_LEN >= 4096)
    if (dh_rfc3526_4096_4095_std_test())
    {
        return 1;
    }
#endif

// rand test
#if (DH_MAX_BIT_LEN >= 1024)
    if (dh_static_1024_160_rand_test())
    {
        return 1;
    }
#endif

#if (DH_MAX_BIT_LEN >= 1024)
    if (dh_ephemeral_1024_160_rand_test())
    {
        return 1;
    }
#endif

#if (DH_MAX_BIT_LEN >= 2048)
    if (dh_rfc5114_2048_224_rand_test())
    {
        return 1;
    }
#endif

#if (DH_MAX_BIT_LEN >= 3072)
    if (dh_rfc3526_3072_3071_rand_test())
    {
        return 1;
    }
#endif

#if (DH_MAX_BIT_LEN >= 4096)
    if (dh_rfc3526_4096_4095_rand_test())
    {
        return 1;
    }
#endif

#endif

    return 0;
}

#endif
